

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Single molecule FRET analysis &#8212; sdt-python 18.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fret';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Image filtering and processing" href="image.html" />
    <link rel="prev" title="Analyze spatial aspects of data" href="spatial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">sdt-python 18.0 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="roi.html">Regions of interest (ROIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multicolor.html">Multi-color data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="motion.html">Diffusion analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="brightness.html">Brightness analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Data input/output</a></li>
<li class="toctree-l1"><a class="reference internal" href="changepoint.html">Changepoint detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatial.html">Analyze spatial aspects of data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Single molecule FRET analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Image filtering and processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="flatfield.html">Flat-field correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="loc.html">Fluorescent feature localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbui.html">GUIs for the Jupyter notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="sim.html">Simulation of microscopy-related data</a></li>
<li class="toctree-l1"><a class="reference internal" href="funcs.html">Special functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot.html">Plotting utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimize.html">Optimization and fitting algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="helper.html">Helpers for writing new code</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Change log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/schuetzgroup/sdt-python" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/fret.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Single molecule FRET analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tracking">Tracking</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.frame_selector"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.frame_selector</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.registrator"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.registrator</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.link_options"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.link_options</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.min_length"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.min_length</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.brightness_options"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.brightness_options</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.interpolate"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.interpolate</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.coloc_dist"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.coloc_dist</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.acceptor_channel"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.acceptor_channel</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.columns"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.columns</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.neighbor_radius"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.neighbor_radius</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.excitation_seq"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.excitation_seq</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.track"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.track()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.flag_excitation_type"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.flag_excitation_type()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.to_yaml"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.to_yaml()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.from_yaml"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.from_yaml()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-filtering">Analysis and Filtering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.bleach_thresh"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.bleach_thresh</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.tracks"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.tracks</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.cp_detector"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.cp_detector</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.columns"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.columns</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.leakage"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.leakage</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.direct_excitation"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.direct_excitation</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.detection_eff"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.detection_eff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.excitation_eff"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.excitation_eff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.reset_filters"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.reset_filters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_fret_values"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_fret_values()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.apply_filters"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.apply_filters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.mass_changepoints"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.mass_changepoints()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.bleach_step"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.bleach_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.query"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.query()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.query_particles"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.query_particles()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.image_mask"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.image_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.flatfield_correction"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.flatfield_correction()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_leakage"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_leakage()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_direct_excitation"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_direct_excitation()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_detection_eff"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_detection_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_excitation_eff"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_excitation_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_detection_excitation_effs"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_detection_excitation_effs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.fret_correction"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.fret_correction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting">Plotting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.smfret_scatter"><code class="docutils literal notranslate"><span class="pre">smfret_scatter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.smfret_hist"><code class="docutils literal notranslate"><span class="pre">smfret_hist()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.draw_track"><code class="docutils literal notranslate"><span class="pre">draw_track()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#helpers">Helpers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.numeric_exc_type"><code class="docutils literal notranslate"><span class="pre">numeric_exc_type()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.gaussian_mixture_split"><code class="docutils literal notranslate"><span class="pre">gaussian_mixture_split()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.apply_track_filters"><code class="docutils literal notranslate"><span class="pre">apply_track_filters()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <span class="target" id="module-sdt.fret"></span><section id="single-molecule-fret-analysis">
<h1>Single molecule FRET analysis<a class="headerlink" href="#single-molecule-fret-analysis" title="Permalink to this heading">#</a></h1>
<p>The <a class="reference internal" href="#module-sdt.fret" title="sdt.fret"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sdt.fret</span></code></a> module provides functionality to analyze single
molecule FRET data. This includes</p>
<ul class="simple">
<li><p>tracking and measurement of FRET-related quantities using the
<a class="reference internal" href="#sdt.fret.SmFRETTracker" title="sdt.fret.SmFRETTracker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmFRETTracker</span></code></a> class.</p></li>
<li><p>analyzing and filtering of the data with help of <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer" title="sdt.fret.SmFRETAnalyzer"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmFRETAnalyzer</span></code></a>.</p></li>
<li><p>functions for plotting results, such as <a class="reference internal" href="#sdt.fret.smfret_scatter" title="sdt.fret.smfret_scatter"><code class="xref py py-func docutils literal notranslate"><span class="pre">smfret_scatter()</span></code></a>,
<a class="reference internal" href="#sdt.fret.smfret_hist" title="sdt.fret.smfret_hist"><code class="xref py py-func docutils literal notranslate"><span class="pre">smfret_hist()</span></code></a>, and <a class="reference internal" href="#sdt.fret.draw_track" title="sdt.fret.draw_track"><code class="xref py py-func docutils literal notranslate"><span class="pre">draw_track()</span></code></a>.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Load data for tracking:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chromatic_corr</span> <span class="o">=</span> <span class="n">multicolor</span><span class="o">.</span><span class="n">Registrator</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;cc.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">donor_loc</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;donor.h5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acceptor_loc</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;acceptor.h5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">donor_img</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">ImageSequence</span><span class="p">(</span><span class="s2">&quot;donor.tif&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acceptor_img</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">ImageSequence</span><span class="p">(</span><span class="s2">&quot;acceptor.tif&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</pre></div>
</div>
<p>Tracking of single molecule FRET signals. This involves merging features
from donor and acceptor channels, the actual tracking, getting the
brightness of the donor and the acceptor for each localization from the
raw images and much more.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tracker</span> <span class="o">=</span> <span class="n">SmFRETTracker</span><span class="p">(</span><span class="s2">&quot;dddda&quot;</span><span class="p">,</span> <span class="n">chromatic_corr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trc</span> <span class="o">=</span> <span class="n">tracker</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">donor_img</span><span class="p">,</span> <span class="n">acceptor_img</span><span class="p">,</span> <span class="n">donor_loc</span><span class="p">,</span> <span class="n">acceptor_loc</span><span class="p">)</span>
</pre></div>
</div>
<p>Now these data can be analyzed and filtered. Calculate FRET-related quantities
such as FRET efficiency, stoichiometry, etc.:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span> <span class="o">=</span> <span class="n">SmFRETAnalyzer</span><span class="p">(</span><span class="n">trc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span><span class="o">.</span><span class="n">calc_fret_values</span><span class="p">()</span>
</pre></div>
</div>
<p>Let us reject any tracks where the acceptor does not bleach in a single step:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span><span class="o">.</span><span class="n">acceptor_bleach_step</span><span class="p">(</span><span class="s2">&quot;acceptor&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Remove any tracks where the mass upon acceptor excitation does not exceed
500 counts at least once</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span><span class="o">.</span><span class="n">query_particles</span><span class="p">(</span><span class="s2">&quot;fret_a_mass &gt; 500&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Accept only localizations that lie in pixels where the boolean mask is <cite>True</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;mask.npy&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span><span class="o">.</span><span class="n">image_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="s2">&quot;donor&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Filtered data can be accessed via the <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SmFRETAnalyzer.tracks</span></code></a>
attribute.</p>
<p>Draw a scatter plot of FRET efficiency vs. stoichiometry:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smfret_scatter</span><span class="p">({</span><span class="s2">&quot;data1&quot;</span><span class="p">:</span> <span class="n">filt</span><span class="o">.</span><span class="n">tracks</span><span class="p">},</span> <span class="p">(</span><span class="s2">&quot;fret&quot;</span><span class="p">,</span> <span class="s2">&quot;eff), (&quot;</span><span class="n">fret</span><span class="s2">&quot;, &quot;</span><span class="n">stoi</span><span class="s2">&quot;))</span>
</pre></div>
</div>
<section id="tracking">
<h2>Tracking<a class="headerlink" href="#tracking" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sdt.fret.</span></span><span class="sig-name descname"><span class="pre">SmFRETTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excitation_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'da'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">registrator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_mem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coloc_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptor_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_track.html#SmFRETTracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETTracker" title="Permalink to this definition">#</a></dt>
<dd><p>Class for tracking of smFRET data</p>
<p>There is support for dumping and loading to/from YAML using
<code class="xref py py-mod docutils literal notranslate"><span class="pre">sdt.io.yaml</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>excitation_seq</strong> (<em>str</em>) – Set the <a class="reference internal" href="#sdt.fret.SmFRETTracker.excitation_seq" title="sdt.fret.SmFRETTracker.excitation_seq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">excitation_seq</span></code></a> attribute.</p></li>
<li><p><strong>registrator</strong> (<a class="reference internal" href="multicolor.html#sdt.multicolor.Registrator" title="sdt.multicolor.registrator.Registrator"><em>sdt.multicolor.registrator.Registrator</em></a>) – Registrator used to overlay channels. If <cite>None</cite>, use the identity
transform.</p></li>
<li><p><strong>link_radius</strong> (<em>float</em>) – Maximum movement of features between frames. See <cite>search_range</cite>
option of <code class="xref py py-func docutils literal notranslate"><span class="pre">trackpy.link_df()</span></code>.</p></li>
<li><p><strong>link_mem</strong> (<em>int</em>) – Maximum number of frames for which a feature may not be detected.
See <cite>memory</cite> option of <code class="xref py py-func docutils literal notranslate"><span class="pre">trackpy.link_df()</span></code>.</p></li>
<li><p><strong>min_length</strong> (<em>int</em>) – Minimum length of tracks.</p></li>
<li><p><strong>feat_radius</strong> (<em>int</em>) – Radius of circle that is a little larger than features. See
<cite>radius</cite> option of <code class="xref py py-func docutils literal notranslate"><span class="pre">brightness.from_raw_image()</span></code>.</p></li>
<li><p><strong>bg_frame</strong> (<em>int</em>) – Size of frame around features for background determination. See
<cite>bg_frame</cite> option of <code class="xref py py-func docutils literal notranslate"><span class="pre">brightness.from_raw_image()</span></code>.</p></li>
<li><p><strong>bg_estimator</strong> (<em>str</em><em> | </em><em>Callable</em><em>[</em><em>[</em><em>ndarray</em><em>]</em><em>, </em><em>float</em><em>]</em>) – Statistic to estimate background. See <cite>bg_estimator</cite> option of
<code class="xref py py-func docutils literal notranslate"><span class="pre">brightness.from_raw_image()</span></code>.</p></li>
<li><p><strong>neighbor_radius</strong> (<em>float</em>) – How far two features may be apart while still being considered
close enough so that one influences the brightness measurement of
the other. This is related to the <cite>radius</cite> option of
<code class="xref py py-func docutils literal notranslate"><span class="pre">brightness.from_raw_image()</span></code>. If “auto”, use the smallest
value that avoids overlaps.</p></li>
<li><p><strong>interpolate</strong> (<em>bool</em>) – Whether to interpolate coordinates of features that have been
missed by the localization algorithm.</p></li>
<li><p><strong>coloc_dist</strong> (<em>float</em>) – After overlaying donor and acceptor channel features, this gives
the maximum distance up to which donor and acceptor signal are
considered to come from the same molecule.</p></li>
<li><p><strong>acceptor_channel</strong> (<em>int</em>) – Whether the acceptor channel is number 1 or 2 in <cite>registrator</cite>.</p></li>
<li><p><strong>link_options</strong> (<em>Dict</em>) – Specify additional options to <code class="xref py py-func docutils literal notranslate"><span class="pre">trackpy.link_df()</span></code>.
“search_range” and “memory” will be overwritten by the
<cite>link_radius</cite> and <cite>link_mem</cite> parameters.</p></li>
<li><p><strong>link_quiet</strong> (<em>bool</em>) – If <cite>True</cite>, call <code class="xref py py-func docutils literal notranslate"><span class="pre">trackpy.quiet()</span></code>.</p></li>
<li><p><strong>columns</strong> (<em>Dict</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. Relevant names are <cite>coords</cite>, <cite>time</cite>,
<cite>mass</cite>, <cite>signal</cite>, <cite>bg</cite>, <cite>bg_dev</cite>. This means, if your DataFrame has
coordinate columns “x” and “z” and the time column “alt_frame”, set
<code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;],</span> <span class="pre">&quot;time&quot;:</span> <span class="pre">&quot;alt_frame&quot;}</span></code>. This
parameters sets the <a class="reference internal" href="#sdt.fret.SmFRETTracker.columns" title="sdt.fret.SmFRETTracker.columns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">columns</span></code></a> attribute.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.frame_selector">
<span class="sig-name descname"><span class="pre">frame_selector</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="multicolor.html#sdt.multicolor.FrameSelector" title="sdt.multicolor.frame_selector.FrameSelector"><span class="pre">FrameSelector</span></a></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.frame_selector" title="Permalink to this definition">#</a></dt>
<dd><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">FrameSelector</span></code> instance with the matching
<a class="reference internal" href="#sdt.fret.SmFRETTracker.excitation_seq" title="sdt.fret.SmFRETTracker.excitation_seq"><code class="xref py py-attr docutils literal notranslate"><span class="pre">excitation_seq</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.registrator">
<span class="sig-name descname"><span class="pre">registrator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="multicolor.html#sdt.multicolor.Registrator" title="sdt.multicolor.registrator.Registrator"><span class="pre">Registrator</span></a></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.registrator" title="Permalink to this definition">#</a></dt>
<dd><p>multicolor.Registrator used to overlay channels</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.link_options">
<span class="sig-name descname"><span class="pre">link_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.link_options" title="Permalink to this definition">#</a></dt>
<dd><p>Options passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">trackpy.link_df()</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.min_length">
<span class="sig-name descname"><span class="pre">min_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.min_length" title="Permalink to this definition">#</a></dt>
<dd><p>Minimum length of tracks</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.brightness_options">
<span class="sig-name descname"><span class="pre">brightness_options</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.brightness_options" title="Permalink to this definition">#</a></dt>
<dd><p>Options passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">brightness.from_raw_image()</span></code>. Make sure to
adjust <a class="reference internal" href="#sdt.fret.SmFRETTracker.neighbor_radius" title="sdt.fret.SmFRETTracker.neighbor_radius"><code class="xref py py-attr docutils literal notranslate"><span class="pre">neighbor_radius</span></code></a> if you change either the <cite>mask</cite> or the
<cite>radius</cite> option!</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.interpolate" title="Permalink to this definition">#</a></dt>
<dd><p>Whether to interpolate coordinates of features that have been missed
by the localization algorithm.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.coloc_dist">
<span class="sig-name descname"><span class="pre">coloc_dist</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.coloc_dist" title="Permalink to this definition">#</a></dt>
<dd><p>After overlaying donor and acceptor channel features, this gives the
maximum distance up to which donor and acceptor signal are considered
to come from the same molecule.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.acceptor_channel">
<span class="sig-name descname"><span class="pre">acceptor_channel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.acceptor_channel" title="Permalink to this definition">#</a></dt>
<dd><p>Can be either 1 or 2, depending the acceptor is the first or the
second channel in <a class="reference internal" href="#sdt.fret.SmFRETTracker.registrator" title="sdt.fret.SmFRETTracker.registrator"><code class="xref py py-attr docutils literal notranslate"><span class="pre">registrator</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.columns">
<span class="sig-name descname"><span class="pre">columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.columns" title="Permalink to this definition">#</a></dt>
<dd><p>Column names in DataFrames. Defaults are taken from
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.neighbor_radius">
<span class="sig-name descname"><span class="pre">neighbor_radius</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.neighbor_radius" title="Permalink to this definition">#</a></dt>
<dd><p>How far two features may be apart while still being considered close
enough so that one influences the brightness measurement of the other.
This is related to the <cite>radius</cite> option of
<code class="xref py py-func docutils literal notranslate"><span class="pre">brightness.from_raw_image()</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.excitation_seq">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">excitation_seq</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sdt.fret.SmFRETTracker.excitation_seq" title="Permalink to this definition">#</a></dt>
<dd><p>Excitation sequence. “d” stands for donor, “a” for acceptor,
anything else describes other kinds of frames which are irrelevant for
tracking.</p>
<p>One needs only specify the shortest sequence that is repeated,
i. e. “ddddaddddadddda” is the same as “dddda”.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.track">
<span class="sig-name descname"><span class="pre">track</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">donor_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptor_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">donor_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptor_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_track.html#SmFRETTracker.track"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETTracker.track" title="Permalink to this definition">#</a></dt>
<dd><p>Track smFRET data</p>
<p>Localization data for both the donor and the acceptor channel is
merged (since a FRET construct has to be visible in at least one
channel). The merged data is than linked into trajectories using
py:func:<cite>trackpy.link_df</cite>. For this the <code class="xref py py-mod docutils literal notranslate"><span class="pre">trackpy</span></code> package needs
to be installed. Additionally, the feature brightness is determined for
both donor and acceptor for raw image data using
<code class="xref py py-func docutils literal notranslate"><span class="pre">brightness.from_raw_image()</span></code>. These data are written into a
a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> whose columns have a MultiIndex
containing the “donor” and “acceptor” items in the top level.</p>
<p>A column specifying whether the entry originates from donor or
acceptor excitation is also added: (“fret”, “exc_type”). It is “d”
for donor and “a” for acceptor excitation; see the
<a class="reference internal" href="#sdt.fret.SmFRETTracker.flag_excitation_type" title="sdt.fret.SmFRETTracker.flag_excitation_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flag_excitation_type()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>donor_img</strong> (<em>Sequence</em><em>[</em><em>ndarray</em><em>]</em>) – Raw image frames for donor and acceptor channel. This need to be
of type <cite>list</cite>, but anything that returns image data when indexed
with a frame number will do.</p></li>
<li><p><strong>acceptor_img</strong> (<em>Sequence</em><em>[</em><em>ndarray</em><em>]</em>) – Raw image frames for donor and acceptor channel. This need to be
of type <cite>list</cite>, but anything that returns image data when indexed
with a frame number will do.</p></li>
<li><p><strong>donor_loc</strong> (<em>DataFrame</em>) – Localization data for donor and acceptor channel</p></li>
<li><p><strong>acceptor_loc</strong> (<em>DataFrame</em>) – Localization data for donor and acceptor channel</p></li>
<li><p><strong>d_mass</strong> (<em>bool</em>) – <p>If <cite>True</cite>, get total brightness upon donor excitation by
from the sum of donor and acceptor image. If <cite>False</cite>, the
donor excitation brightness can still be calculated as the sum of
donor and acceptor brightness in <code class="xref py py-meth docutils literal notranslate"><span class="pre">analyze()</span></code>. Defaults to
<cite>False</cite>.</p>
<p>Note: Until <code class="xref py py-mod docutils literal notranslate"><span class="pre">slicerator</span></code> with support for multiple
inputs to pipelines is released, setting this to <cite>True</cite> will load
all of <cite>donor_img</cite> and <cite>acceptor_img</cite> into memory, even if
<code class="xref py py-mod docutils literal notranslate"><span class="pre">pims</span></code> is used.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>The columns are indexed with a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.MultiIndex</span></code>.</p></li>
<li><p><em>The top index level consists of “donor” (tracking data for the</em></p></li>
<li><p><em>donor channel), “acceptor” (tracking data for the acceptor</em></p></li>
<li><p><em>channel), and “fret”. The latter contains a column with the</em></p></li>
<li><p><em>particle number (“particle”), an indicator (0 / 1) whether there</em></p></li>
<li><p><em>is a near neighbor (“has_neighbor”), and an indicator whether the</em></p></li>
<li><p><em>data point was interpolated (“interp”) because it was not in the</em></p></li>
<li><p><em>localization data in either channel.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.flag_excitation_type">
<span class="sig-name descname"><span class="pre">flag_excitation_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_track.html#SmFRETTracker.flag_excitation_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETTracker.flag_excitation_type" title="Permalink to this definition">#</a></dt>
<dd><p>Add a column indicating excitation type (donor/acceptor/…)</p>
<p>Add  (“fret”, “exc_type”) column in place. It is of “category” type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tracks</strong> (<em>DataFrame</em>) – Result of <a class="reference internal" href="#sdt.fret.SmFRETTracker.track" title="sdt.fret.SmFRETTracker.track"><code class="xref py py-meth docutils literal notranslate"><span class="pre">track()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.to_yaml">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dumper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_track.html#SmFRETTracker.to_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETTracker.to_yaml" title="Permalink to this definition">#</a></dt>
<dd><p>Dump as YAML</p>
<p>Pass this as the <cite>representer</cite> parameter to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">yaml.Dumper.add_representer()</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETTracker.from_yaml">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_track.html#SmFRETTracker.from_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETTracker.from_yaml" title="Permalink to this definition">#</a></dt>
<dd><p>Construct from YAML</p>
<p>Pass this as the <cite>constructor</cite> parameter to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">yaml.Loader.add_constructor()</span></code></p>
</dd></dl>

</dd></dl>

</section>
<section id="analysis-and-filtering">
<h2>Analysis and Filtering<a class="headerlink" href="#analysis-and-filtering" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sdt.fret.</span></span><span class="sig-name descname"><span class="pre">SmFRETAnalyzer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_detector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer" title="Permalink to this definition">#</a></dt>
<dd><p>Class for analyzing and filtering of smFRET data</p>
<p>This provides various analysis and filtering methods which act on the
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> attribute.</p>
<p>Correction of FRET efficiencies and stoichiometries for donor leakage and
direct acceptor excitation is implemented according to <a class="reference internal" href="#hell2018" id="id1"><span>[Hell2018]</span></a>,
while different detection efficiencies for the different
fluorophores are accounted for as described in <a class="reference internal" href="#macc2010" id="id2"><span>[MacC2010]</span></a> as well
the different excitation efficiencies according to <a class="reference internal" href="#lee2005" id="id3"><span>[Lee2005]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (<em>pandas.core.frame.DataFrame</em>) – smFRET tracking data as produced by <a class="reference internal" href="#sdt.fret.SmFRETTracker" title="sdt.fret.SmFRETTracker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmFRETTracker</span></code></a> by
running its <a class="reference internal" href="#sdt.fret.SmFRETTracker.track" title="sdt.fret.SmFRETTracker.track"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SmFRETTracker.track()</span></code></a> method.</p></li>
<li><p><strong>cp_detector</strong> (<em>Any</em>) – Changepoint detetctor. If <cite>None</cite>, create a
<code class="xref py py-class docutils literal notranslate"><span class="pre">changepoint.Pelt</span></code> instance with <code class="docutils literal notranslate"><span class="pre">model=&quot;l2&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">min_size=1</span></code>, and <code class="docutils literal notranslate"><span class="pre">jump=1</span></code>.</p></li>
<li><p><strong>copy</strong> (<em>bool</em>) – If <cite>True</cite>, copy <cite>tracks</cite> to the <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> attribute.</p></li>
<li><p><strong>reset_filters</strong> (<em>bool</em>) – If <cite>True</cite>, reset filters in <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a>. See also
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.reset_filters" title="sdt.fret.SmFRETAnalyzer.reset_filters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset_filters()</span></code></a>.</p></li>
<li><p><strong>keep_filters</strong> (<em>str</em><em> | </em><em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Filter columns to keep upon resetting. See also
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.reset_filters" title="sdt.fret.SmFRETAnalyzer.reset_filters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset_filters()</span></code></a>.</p></li>
<li><p><strong>columns</strong> (<em>Dict</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. Relevant names are <cite>coords</cite> and <cite>time</cite>.
This means, if your DataFrame has
coordinate columns “x” and “z” and the time column “alt_frame”, set
<code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;],</span> <span class="pre">&quot;time&quot;:</span> <span class="pre">&quot;alt_frame&quot;}</span></code>. This
parameters sets the <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.columns" title="sdt.fret.SmFRETAnalyzer.columns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">columns</span></code></a> attribute.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.bleach_thresh">
<span class="sig-name descname"><span class="pre">bleach_thresh</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(500.0,</span> <span class="pre">500.0)</span></em><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.bleach_thresh" title="Permalink to this definition">#</a></dt>
<dd><p>Intensity (mass) thresholds upon donor and acceptor excitation,
respecitively, below which a signal is considered bleached. Used for
bleaching step analysis.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.tracks">
<span class="sig-name descname"><span class="pre">tracks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.tracks" title="Permalink to this definition">#</a></dt>
<dd><p>smFRET tracking data</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.cp_detector">
<span class="sig-name descname"><span class="pre">cp_detector</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.cp_detector" title="Permalink to this definition">#</a></dt>
<dd><p>Changepoint detector class instance used to perform bleching step
detection.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.columns">
<span class="sig-name descname"><span class="pre">columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.columns" title="Permalink to this definition">#</a></dt>
<dd><p>Column names to use in DataFrames. See <code class="xref py py-func docutils literal notranslate"><span class="pre">config.set_columns()</span></code>
for details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.leakage">
<span class="sig-name descname"><span class="pre">leakage</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.leakage" title="Permalink to this definition">#</a></dt>
<dd><p>Correction factor for donor leakage into the acceptor channel;
<span class="math notranslate nohighlight">\(\alpha\)</span> in <a class="reference internal" href="#hell2018" id="id4"><span>[Hell2018]</span></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.direct_excitation">
<span class="sig-name descname"><span class="pre">direct_excitation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.direct_excitation" title="Permalink to this definition">#</a></dt>
<dd><p>Correction factor for direct acceptor excitation by the donor
laser; <span class="math notranslate nohighlight">\(\delta\)</span> in <a class="reference internal" href="#hell2018" id="id5"><span>[Hell2018]</span></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.detection_eff">
<span class="sig-name descname"><span class="pre">detection_eff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.detection_eff" title="Permalink to this definition">#</a></dt>
<dd><p>Correction factor(s) for the detection efficiency difference
beteen donor and acceptor fluorophore; <span class="math notranslate nohighlight">\(\gamma\)</span> in [Hell2018].</p>
<p>Can be a scalar for global correction or a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code>
for individual correction. In the latter case, the index is the
particle number and the value is the correction factor.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.excitation_eff">
<span class="sig-name descname"><span class="pre">excitation_eff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.excitation_eff" title="Permalink to this definition">#</a></dt>
<dd><p>Correction factor(s) for the excitation efficiency difference
beteen donor and acceptor fluorophore; <span class="math notranslate nohighlight">\(\beta\)</span> in [Hell2018].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.reset_filters">
<span class="sig-name descname"><span class="pre">reset_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.reset_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.reset_filters" title="Permalink to this definition">#</a></dt>
<dd><p>Reset filters</p>
<p>This drops filter columns from <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keep</strong> (<em>str</em><em> | </em><em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Filter column name(s) to keep</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.calc_fret_values">
<span class="sig-name descname"><span class="pre">calc_fret_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_d_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_mass_interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest-up'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.calc_fret_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.calc_fret_values" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate FRET-related values</p>
<p>This needs to be called before the filtering methods and before
calculating the true FRET efficiencies and stoichiometries. However,
any corrections to the donor and acceptor localization data (such as
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.flatfield_correction" title="sdt.fret.SmFRETAnalyzer.flatfield_correction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flatfield_correction()</span></code></a>) need to be done before this.</p>
<p>Calculated values apparent FRET efficiencies and stoichiometries,
the total brightness (mass) upon donor excitation, and the acceptor
brightness (mass) upon direct excitation, which is interpolated for
donor excitation datapoints in order to allow for calculation of
stoichiometries.</p>
<p>For each localization in <cite>tracks</cite>, the total brightness upon donor
excitation is calculated by taking the sum of <code class="docutils literal notranslate"><span class="pre">(&quot;donor&quot;,</span> <span class="pre">&quot;mass&quot;)</span></code>
and <code class="docutils literal notranslate"><span class="pre">(&quot;acceptor&quot;,</span> <span class="pre">&quot;mass&quot;)</span></code> values. It is added as a
<code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;d_mass&quot;)</span></code> column to the <cite>tracks</cite> DataFrame. The
apparent FRET efficiency (acceptor brightness (mass) divided by sum of
donor and acceptor brightnesses) is added as a
<code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;eff_app&quot;)</span></code> column to the <cite>tracks</cite> DataFrame.</p>
<p>The apparent stoichiometry value <span class="math notranslate nohighlight">\(S_\text{app}\)</span> is given as</p>
<div class="math notranslate nohighlight">
\[S_\text{app} = \frac{I_{DD} + I_{DA}}{I_{DD} + I_{DA} +
I_{AA}}\]</div>
<p>as in <a class="reference internal" href="#hell2018" id="id6"><span>[Hell2018]</span></a>. <span class="math notranslate nohighlight">\(I_{DD}\)</span> is the donor brightness upon donor
excitation, <span class="math notranslate nohighlight">\(I_{DA}\)</span> is the acceptor brightness upon donor
excitation, and <span class="math notranslate nohighlight">\(I_{AA}\)</span> is the acceptor brightness upon
acceptor excitation. The latter is calculated by interpolation for
frames with donor excitation.</p>
<p><span class="math notranslate nohighlight">\(I_{AA}\)</span> is append as a <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;a_mass&quot;)</span></code> column.
The stoichiometry value is added in the <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;stoi_app&quot;)</span></code>
column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_d_mass</strong> (<em>bool</em>) – If a <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;d_mass&quot;)</span></code> column is already present in <cite>tracks</cite>,
use that instead of overwriting it with the sum of
<code class="docutils literal notranslate"><span class="pre">(&quot;donor&quot;,</span> <span class="pre">&quot;mass&quot;)</span></code> and <code class="docutils literal notranslate"><span class="pre">(&quot;acceptor&quot;,</span> <span class="pre">&quot;mass&quot;)</span></code> values. Useful
if <code class="xref py py-meth docutils literal notranslate"><span class="pre">track()</span></code> was called with <code class="docutils literal notranslate"><span class="pre">d_mass=True</span></code>.</p></li>
<li><p><strong>invalid_nan</strong> (<em>bool</em>) – If True, all “d_mass”, “eff_app”, and “stoi_app” values for
excitation types other than donor excitation are set to NaN, since
the values don’t make sense.</p></li>
<li><p><strong>a_mass_interp</strong> (<em>str</em>) – How to interpolate the acceptor mass upon direct excitation in
donor excitation frames. Sensible values are “linear” for linear
interpolation; “nearest” to take the value of the closest
direct acceptor excitation frame (using the previous frame in case
of a tie); “nearest-up”, which is similar to “nearest” but takes
the next frame in case of a tie; “next” and “previous” to use the
next and previous frames, respectively.</p></li>
<li><p><strong>skip_neighbors</strong> (<em>bool</em>) – If <cite>True</cite>, skip localizations where <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;has_neighbor&quot;)</span></code> is
<cite>True</cite> when interpolating acceptor mass upon direct excitation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.apply_filters">
<span class="sig-name descname"><span class="pre">apply_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.apply_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.apply_filters" title="Permalink to this definition">#</a></dt>
<dd><p>Apply filters to <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a></p>
<p>This removes all entries from <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> that have been marked
as filtered using e.g. <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.query" title="sdt.fret.SmFRETAnalyzer.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">query_particle()</span></code>,
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.bleach_step" title="sdt.fret.SmFRETAnalyzer.bleach_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bleach_step()</span></code></a>, and <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.image_mask" title="sdt.fret.SmFRETAnalyzer.image_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">image_mask()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_negative</strong> (<em>bool</em>) – If <cite>False</cite>, include only entries for which all <code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column
values are zero. If <cite>True</cite>, include also entries with negative
<code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column values.</p></li>
<li><p><strong>ignore</strong> (<em>str</em><em> | </em><em>Sequence</em><em>[</em><em>str</em><em>]</em>) – <code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column(s) to ignore when deciding whether to include
an entry or not. For instance, setting <code class="docutils literal notranslate"><span class="pre">ignore=&quot;bleach_step&quot;</span></code>
will not consider the <code class="docutils literal notranslate"><span class="pre">(&quot;filter&quot;,</span> <span class="pre">&quot;bleach_step&quot;)</span></code> column values.</p></li>
<li><p><strong>ret_type</strong> (<em>str</em>) – If <code class="docutils literal notranslate"><span class="pre">&quot;data&quot;</span></code>, return a copy of <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> excluding all
entries that have been marked as filtered, i.e., that have a
positive (or nonzero, see the <cite>include_negative</cite> parameter) entry
in any <code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column.
If <code class="docutils literal notranslate"><span class="pre">&quot;mask&quot;</span></code>, return a boolean array indicating whether an entry
is to be removed or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Copy of <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> with all filtered rows removed or</p></li>
<li><p><em>corresponding boolean mask.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em> | <em>array</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.mass_changepoints">
<span class="sig-name descname"><span class="pre">mass_changepoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat_margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.mass_changepoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.mass_changepoints" title="Permalink to this definition">#</a></dt>
<dd><p>Segment tracks by changepoint detection in brightness time trace</p>
<p>Changepoint detection is run on the donor or acceptor brightness
(<code class="docutils literal notranslate"><span class="pre">mass</span></code>) time trace, depending on the <cite>channels</cite> argument.
This appends py:attr:<cite>tracks</cite> with a <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;d_seg&quot;)</span></code> or
<cite>(“fret”, “a_seg”)`</cite> column for donor or acceptor, resp. For
each localization, this holds the number of the segment it belongs to.
Furthermore, statistics (such as median brightness) can/should be
calculated, which can later be used to analyze stepwise bleaching
(see <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.bleach_step" title="sdt.fret.SmFRETAnalyzer.bleach_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bleach_step()</span></code></a>).</p>
<p><strong>:py:attr:`tracks` will be sorted according to
``(“fret”, “particle”)`` and ``(“donor”, self.columns[“time”])`` in the
process.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel</strong> (<em>str</em>) – In which channel (<code class="docutils literal notranslate"><span class="pre">&quot;donor&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;acceptor&quot;</span></code>) to perform
changepoint detection.</p></li>
<li><p><strong>stats</strong> (<em>Callable</em><em> | </em><em>str</em><em> | </em><em>Iterable</em><em>[</em><em>Callable</em><em> | </em><em>str</em><em>]</em>) – Statistics to calculate for each track segment. For each entry
<code class="docutils literal notranslate"><span class="pre">s</span></code>, a column named <code class="docutils literal notranslate"><span class="pre">&quot;{channel}_seg_{s}&quot;</span></code> is appendend, where
<code class="docutils literal notranslate"><span class="pre">channel</span></code> is <code class="docutils literal notranslate"><span class="pre">d</span></code> for donor and <code class="docutils literal notranslate"><span class="pre">a</span></code> for acceptor.
<code class="docutils literal notranslate"><span class="pre">s</span></code> can be the name of a numpy function or a callable returning
a statistic, such as <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.mean()</span></code>.</p></li>
<li><p><strong>stat_margin</strong> (<em>int</em>) – Number of data points around a changepoint to exclude from
statistics calculation. This can prevent bias in the statistics due
to recording a bleaching event in progress.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments to pass to <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.cp_detector" title="sdt.fret.SmFRETAnalyzer.cp_detector"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cp_detector</span></code></a>
<cite>find_changepoints()</cite> method.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Pass <code class="docutils literal notranslate"><span class="pre">penalty=1e6</span></code> to the changepoint detector’s
<code class="docutils literal notranslate"><span class="pre">find_changepoints</span></code> method, perform detection both channels:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span><span class="o">.</span><span class="n">mass_changepoints</span><span class="p">(</span><span class="s2">&quot;donor&quot;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="mf">1e6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span><span class="o">.</span><span class="n">mass_changepoints</span><span class="p">(</span><span class="s2">&quot;acceptor&quot;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="mf">1e6</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.bleach_step">
<span class="sig-name descname"><span class="pre">bleach_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'donor</span> <span class="pre">or</span> <span class="pre">acceptor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reason</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bleach_step'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.bleach_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.bleach_step" title="Permalink to this definition">#</a></dt>
<dd><p>Find tracks with acceptable fluorophore bleaching behavior</p>
<p>What “acceptable” means is specified by the <cite>condition</cite> parameter.</p>
<p><code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;d_seg&quot;)</span></code>, <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">f&quot;d_seg_{stat}&quot;)</span></code>, <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span>
<span class="pre">&quot;a_seg&quot;)</span></code>, and <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">f&quot;a_seg_{stat}&quot;)</span></code> (where <code class="docutils literal notranslate"><span class="pre">{stat}</span></code> is
replaced by the value of the <cite>stat</cite> parameter) columns need to be
present in <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> for this to work, which can be achieved by
performing changepoint in both channels using <code class="xref py py-meth docutils literal notranslate"><span class="pre">segment_mass()</span></code>.</p>
<p>The donor considered bleached if its <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">f&quot;d_seg_{stat}&quot;)</span></code>
is below <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.bleach_thresh" title="sdt.fret.SmFRETAnalyzer.bleach_thresh"><code class="xref py py-attr docutils literal notranslate"><span class="pre">bleach_thresh</span></code></a> <code class="docutils literal notranslate"><span class="pre">[0]</span></code>. The acceptor considered
bleached if its <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">f&quot;a_seg_{stat}&quot;)</span></code> is below
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.bleach_thresh" title="sdt.fret.SmFRETAnalyzer.bleach_thresh"><code class="xref py py-attr docutils literal notranslate"><span class="pre">bleach_thresh</span></code></a> <code class="docutils literal notranslate"><span class="pre">[0]</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> (<em>str</em>) – If <code class="docutils literal notranslate"><span class="pre">&quot;donor&quot;</span></code>, accept only tracks where the donor bleaches in a
single step and the acceptor shows either no bleach step or
completely bleaches in a single step.
Likewise, <code class="docutils literal notranslate"><span class="pre">&quot;acceptor&quot;</span></code> will accept only tracks where the acceptor
bleaches fully in one step and the donor shows no partial
bleaching.
<code class="docutils literal notranslate"><span class="pre">donor</span> <span class="pre">or</span> <span class="pre">acceptor</span></code> requires that one channel bleaches in a
single step while the other either also bleaches in one step or not
at all (no partial bleaching).
If <code class="docutils literal notranslate"><span class="pre">&quot;no</span> <span class="pre">partial&quot;</span></code>, there may be no partial bleaching, but
bleaching is not required.</p></li>
<li><p><strong>stat</strong> (<em>str</em>) – Statistic to use to determine bleaching steps. Has to be one that
was passed to via <code class="docutils literal notranslate"><span class="pre">stats</span></code> parameter to
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.mass_changepoints" title="sdt.fret.SmFRETAnalyzer.mass_changepoints"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mass_changepoints()</span></code></a>.</p></li>
<li><p><strong>reason</strong> (<em>str</em>) – Filtering reason / column name to use.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Consider acceptors with a brightness <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;a_mass&quot;)</span></code> of less
than 500 counts and donors with a brightness <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;d_mass&quot;)</span></code> of
less than 800 counts bleached. Remove all tracks that don’t show
acceptable bleaching behavior.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span><span class="o">.</span><span class="n">bleach_thresh</span> <span class="o">=</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span><span class="o">.</span><span class="n">bleach_step</span><span class="p">(</span><span class="s2">&quot;donor or acceptor&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mi_sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reason</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'query'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.query" title="Permalink to this definition">#</a></dt>
<dd><p>Filter features according to column values</p>
<p>Flatten the column MultiIndex and filter the resulting DataFrame’s
<cite>eval</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>str</em>) – Filter expression. See <code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.eval()</span></code> for
details.</p></li>
<li><p><strong>mi_sep</strong> (<em>str</em>) – Separate multi-index levels by this character / string.</p></li>
<li><p><strong>reason</strong> (<em>str</em>) – Filtering reason / column name to use.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Remove lines where (“fret”, “a_mass”) &lt;= 500 from <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filt</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;fret_a_mass &gt; 500&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.query_particles">
<span class="sig-name descname"><span class="pre">query_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_abs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mi_sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reason</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'query_p'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.query_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.query_particles" title="Permalink to this definition">#</a></dt>
<dd><p>Remove particles that don’t fulfill <cite>expr</cite> enough times</p>
<p>Any particle that does not fulfill <cite>expr</cite> at least <cite>min_abs</cite> times AND
during at least a fraction of <cite>min_rel</cite> of its length is removed from
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a>.</p>
<p>The column MultiIndex is flattened for this purpose.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>str</em>) – Filter expression. See <code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.eval()</span></code> for
details.</p></li>
<li><p><strong>min_abs</strong> (<em>int</em>) – Minimum number of times a particle has to fulfill <cite>expr</cite>. If
negative, this means “all but <code class="docutils literal notranslate"><span class="pre">abs(min_abs)</span></code>”. If 0, it has
to be fulfilled in all frames.</p></li>
<li><p><strong>min_rel</strong> (<em>float</em>) – Minimum fraction of data points that have to fulfill <cite>expr</cite> for a
particle not to be removed.</p></li>
<li><p><strong>mi_sep</strong> (<em>str</em>) – Use this to separate levels when flattening the column
MultiIndex. Defaults to “_”.</p></li>
<li><p><strong>reason</strong> (<em>str</em>) – Filtering reason / column name to use.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Remove any particles where not (“fret”, “a_mass”) &gt; 500 at least twice
from <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filt</span><span class="o">.</span><span class="n">query_particles</span><span class="p">(</span><span class="s2">&quot;fret_a_mass &gt; 500&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Remove any particles where (“fret”, “a_mass”) &lt;= 500 in more than one
frame:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filt</span><span class="o">.</span><span class="n">query_particles</span><span class="p">(</span><span class="s2">&quot;fret_a_mass &gt; 500&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Remove any particle where not (“fret”, “a_mass”) &gt; 500 for at least
75 % of the particle’s data points, with a minimum of two data points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filt</span><span class="o">.</span><span class="n">query_particles</span><span class="p">(</span><span class="s2">&quot;fret_a_mass &gt; 500&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_rel</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.image_mask">
<span class="sig-name descname"><span class="pre">image_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reason</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image_mask'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.image_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.image_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Filter using a boolean mask image</p>
<p>Remove all lines where coordinates lie in a region where <cite>mask</cite> is
<cite>False</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<em>ndarray</em><em> | </em><em>List</em><em>[</em><em>Dict</em><em>]</em>) – <p>Mask image(s). If this is a single array, apply it to the whole
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> DataFrame.</p>
<p>This can also be a list of dicts, where each dict <code class="docutils literal notranslate"><span class="pre">d</span></code> has to have
a “key” and a “mask” (ndarray) entry. Then each <code class="docutils literal notranslate"><span class="pre">d[&quot;mask&quot;]</span></code> is
applied separately to the corresponding
<code class="docutils literal notranslate"><span class="pre">self.tracks.loc[d[&quot;key&quot;]]</span></code>. Additionally, the dicts may also
have “start” and “stop” entries, in which case the mask will be
applied only to datapoints with frames greater or equal <cite>start</cite> and
less than <cite>stop</cite>; all others will be discarded. With this it is
possible to apply multiple masks to the same key depending on the
frame number.</p>
</p></li>
<li><p><strong>channel</strong> (<em>str</em>) – Channel to use for the filtering</p></li>
<li><p><strong>reason</strong> (<em>str</em>) – Filtering reason / column name to use.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a 2D boolean mask to remove any features that do not have
x and y coordinates between 50 and 100 in the donor channel.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt</span><span class="o">.</span><span class="n">image_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="s2">&quot;donor&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> has a MultiIndex index, where e.g. the first
level is “file1”, “file2”, … and different masks should be applied
for each file, this is possible by passing a list of
dicts. Furthermore, we can apply one mask to all frames up to 100 and
another to the rest:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">masks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">masks</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;file</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">10</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">i</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">masks</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;file</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">i</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt</span><span class="o">.</span><span class="n">image_mask</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="s2">&quot;donor&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.flatfield_correction">
<span class="sig-name descname"><span class="pre">flatfield_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">donor_corr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptor_corr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.flatfield_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.flatfield_correction" title="Permalink to this definition">#</a></dt>
<dd><p>Apply flatfield correction to donor and acceptor localization data</p>
<p>If present, donor and acceptor <code class="docutils literal notranslate"><span class="pre">f&quot;{self.columns['mass']}_pre_flat&quot;</span></code>
and <code class="docutils literal notranslate"><span class="pre">f&quot;{self.columns['signal']}_pre_flat&quot;</span></code> columns are used as inputs
for flatfield correction, results are written to
<code class="docutils literal notranslate"><span class="pre">self.columns[&quot;mass&quot;]</span></code> and <cite>self.columns[“signal”]`</cite>.
Otherwise, <code class="docutils literal notranslate"><span class="pre">self.columns[&quot;mass&quot;]</span></code> and <cite>self.columns[“signal”]`</cite> are
copied to <code class="docutils literal notranslate"><span class="pre">f&quot;{self.columns['mass']}_pre_flat&quot;</span></code>
and <code class="docutils literal notranslate"><span class="pre">f&quot;{self.columns['signal']}_pre_flat&quot;</span></code> first.</p>
<p>Any values derived from those (e.g., apparent FRET efficiencies) need
to be recalculated manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>donor_corr</strong> (<a class="reference internal" href="flatfield.html#sdt.flatfield.Corrector" title="sdt.flatfield.Corrector"><em>Corrector</em></a>) – Corrector instances for donor and acceptor channel, respectivey.</p></li>
<li><p><strong>acceptor_corr</strong> (<a class="reference internal" href="flatfield.html#sdt.flatfield.Corrector" title="sdt.flatfield.Corrector"><em>Corrector</em></a>) – Corrector instances for donor and acceptor channel, respectivey.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.calc_leakage">
<span class="sig-name descname"><span class="pre">calc_leakage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.calc_leakage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.calc_leakage" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate donor leakage (bleed-through) into the acceptor channel</p>
<p>For this to work, <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> must be a dataset of donor-only
molecules. In this case, the leakage <span class="math notranslate nohighlight">\(alpha\)</span> can be
computed using the formula <a class="reference internal" href="#hell2018" id="id7"><span>[Hell2018]</span></a></p>
<div class="math notranslate nohighlight">
\[\alpha = \frac{\langle E_\text{app}\rangle}{1 -
\langle E_\text{app}\rangle},\]</div>
<p>where <span class="math notranslate nohighlight">\(\langle E_\text{app}\rangle\)</span> is the mean apparent FRET
efficiency of a donor-only population.</p>
<p>The leakage <span class="math notranslate nohighlight">\(\alpha\)</span> together with the direct acceptor excitation
<span class="math notranslate nohighlight">\(\delta\)</span> can be used to calculate the real fluorescence due to
FRET,</p>
<div class="math notranslate nohighlight">
\[F_\text{DA} = I_\text{DA} - \alpha I_\text{DD} - \delta
I_\text{AA}.\]</div>
<p>This sets the <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.leakage" title="sdt.fret.SmFRETAnalyzer.leakage"><code class="xref py py-attr docutils literal notranslate"><span class="pre">leakage</span></code></a> attribute.
See <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.fret_correction" title="sdt.fret.SmFRETAnalyzer.fret_correction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fret_correction()</span></code></a> for how use this to calculate corrected
FRET values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.calc_direct_excitation">
<span class="sig-name descname"><span class="pre">calc_direct_excitation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.calc_direct_excitation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.calc_direct_excitation" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate direct acceptor excitation by the donor laser</p>
<p>For this to work, <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> must be a dataset of acceptor-only
molecules. In this case, the direct acceptor excitation <span class="math notranslate nohighlight">\(delta\)</span>
can be computed using the formula <a class="reference internal" href="#hell2018" id="id8"><span>[Hell2018]</span></a></p>
<div class="math notranslate nohighlight">
\[\alpha = \frac{\langle S_\text{app}\rangle}{1 -
\langle S_\text{app}\rangle},\]</div>
<p>where <span class="math notranslate nohighlight">\(\langle ES\text{app}\rangle\)</span> is the mean apparent FRET
stoichiometry of an acceptor-only population.</p>
<p>The leakage <span class="math notranslate nohighlight">\(\alpha\)</span> together with the direct acceptor excitation
<span class="math notranslate nohighlight">\(\delta\)</span> can be used to calculate the real fluorescence due to
FRET,</p>
<div class="math notranslate nohighlight">
\[F_\text{DA} = I_\text{DA} - \alpha I_\text{DD} - \delta
I_\text{AA}.\]</div>
<p>This sets the <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.direct_excitation" title="sdt.fret.SmFRETAnalyzer.direct_excitation"><code class="xref py py-attr docutils literal notranslate"><span class="pre">direct_excitation</span></code></a> attribute.
See <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.fret_correction" title="sdt.fret.SmFRETAnalyzer.fret_correction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fret_correction()</span></code></a> for how use this to calculate corrected
FRET values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.calc_detection_eff">
<span class="sig-name descname"><span class="pre">calc_detection_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_seg_len=5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how=&lt;function</span> <span class="pre">nanmedian&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat=&lt;function</span> <span class="pre">median&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.calc_detection_eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.calc_detection_eff" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate detection efficiency ratio of dyes</p>
<p>The detection efficiency ratio is the ratio of decrease in acceptor
brightness to the increase in donor brightness upon acceptor
photobleaching <a class="reference internal" href="#macc2010" id="id9"><span>[MacC2010]</span></a>:</p>
<div class="math notranslate nohighlight">
\[\gamma = \frac{\langle I_\text{DA}^\text{pre}\rangle -
\langle I_\text{DA}^\text{post}\rangle}{
\langle I_\text{DD}^\text{post}\rangle -
\langle I_\text{DD}^\text{pre}\rangle}\]</div>
<p>This needs molecules with exactly one donor and one acceptor
fluorophore to work. Tracks need to be segmented already (see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">segment_a_mass()</span></code>).</p>
<p>The correction can be calculated for each track individually or some
statistic (e.g. the median) of the indivdual <span class="math notranslate nohighlight">\(gamma\)</span> values can
be used as a global correction factor for all tracks.</p>
<p>The detection efficiency <span class="math notranslate nohighlight">\(\gamma\)</span> can be used to calculate the
real fluorescence of the donor fluorophore,</p>
<div class="math notranslate nohighlight">
\[F_\text{DD} = \gamma I_\text{DD}.\]</div>
<p>This sets the <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.detection_eff" title="sdt.fret.SmFRETAnalyzer.detection_eff"><code class="xref py py-attr docutils literal notranslate"><span class="pre">detection_eff</span></code></a> attribute.
See <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.fret_correction" title="sdt.fret.SmFRETAnalyzer.fret_correction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fret_correction()</span></code></a> for how use this to calculate corrected
FRET values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_seg_len</strong> (<em>int</em>) – How many data points need to be present before and after the
bleach step to ensure a reliable calculation of the mean
intensities. If there are fewer data points, a value of NaN will be
assigned.</p></li>
<li><p><strong>how</strong> (<em>Callable</em><em> | </em><em>str</em>) – If “individual”, the <span class="math notranslate nohighlight">\(\gamma\)</span> value for each track will be
stored and used to correct the values individually when calling
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.fret_correction" title="sdt.fret.SmFRETAnalyzer.fret_correction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fret_correction()</span></code></a>. If a function, apply this function
to the <span class="math notranslate nohighlight">\(\gamma\)</span> array and its return value as a global
correction factor. A sensible example for such a function would be
<code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.nanmean()</span></code>. Beware that some <span class="math notranslate nohighlight">\(\gamma\)</span> may be
NaN.</p></li>
<li><p><strong>stat</strong> (<em>Callable</em><em> | </em><em>str</em>) – Statistic to use to determine bleaching steps. If a string, it has
to be the name of a function from <code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.calc_excitation_eff">
<span class="sig-name descname"><span class="pre">calc_excitation_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.calc_excitation_eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.calc_excitation_eff" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate excitation efficiency ratio of dyes</p>
<p>This is a measure of how efficient the direct acceptor excitation is
compared to the donor excitation. It depends on the fluorophores and
also on the excitation laser intensities.</p>
<p>It can be calculated using the formula <a class="reference internal" href="#lee2005" id="id10"><span>[Lee2005]</span></a></p>
<div class="math notranslate nohighlight">
\[\beta = \frac{1 - \langle S_\gamma \rangle}{
\langle S_\gamma\rangle},\]</div>
<p>where <span class="math notranslate nohighlight">\(S_\gamma\)</span> is calculated like the apparent stoichiometry,
but with the donor and acceptor fluorescence upon donor excitation
already corrected using the leakage, direct excitation, and
detection efficiency factors.</p>
<p>This needs molecules with exactly one donor and one acceptor
fluorophore to work. Tracks need to be segmented already (see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">segment_a_mass()</span></code>). The <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.leakage" title="sdt.fret.SmFRETAnalyzer.leakage"><code class="xref py py-attr docutils literal notranslate"><span class="pre">leakage</span></code></a>,
<a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.direct_excitation" title="sdt.fret.SmFRETAnalyzer.direct_excitation"><code class="xref py py-attr docutils literal notranslate"><span class="pre">direct_excitation</span></code></a>, and <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.detection_eff" title="sdt.fret.SmFRETAnalyzer.detection_eff"><code class="xref py py-attr docutils literal notranslate"><span class="pre">detection_eff</span></code></a> attributes
need to be set correctly.</p>
<p>The excitation efficiency <span class="math notranslate nohighlight">\(\beta\)</span> can be used to correct the
acceptor fluorescence upon acceptor excitation,</p>
<div class="math notranslate nohighlight">
\[F_\text{AA} = I_\text{AA} / \beta.\]</div>
<p>This sets the <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.excitation_eff" title="sdt.fret.SmFRETAnalyzer.excitation_eff"><code class="xref py py-attr docutils literal notranslate"><span class="pre">excitation_eff</span></code></a> attribute.
See <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.fret_correction" title="sdt.fret.SmFRETAnalyzer.fret_correction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fret_correction()</span></code></a> for how use this to calculate corrected
FRET values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> (<em>int</em>) – If &gt; 1, perform a Gaussian mixture fit on the 2D apparent
efficiency-vs.-stoichiomtry dataset. This helps to choose only the
correct component with one donor and one acceptor. Defaults to 1.</p></li>
<li><p><strong>component</strong> (<em>int</em>) – If n_components &gt; 1, use this to choos the component number.
Components are ordered according to decreasing mean apparent FRET
efficiency. <a class="reference internal" href="#sdt.fret.gaussian_mixture_split" title="sdt.fret.gaussian_mixture_split"><code class="xref py py-func docutils literal notranslate"><span class="pre">gaussian_mixture_split()</span></code></a> can be used to
check which component is the desired one. Defaults to 0.</p></li>
<li><p><strong>random_seed</strong> (<em>int</em>) – Seed for the random number generator used to initialize the
Gaussian mixture model fit.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.calc_detection_excitation_effs">
<span class="sig-name descname"><span class="pre">calc_detection_excitation_effs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.calc_detection_excitation_effs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.calc_detection_excitation_effs" title="Permalink to this definition">#</a></dt>
<dd><p>Get detection and excitation efficiency from multi-state sample</p>
<p>States are found in efficiency-vs.-stoichiometry space using a
Gaussian mixture fit. Detection efficiency factor <span class="math notranslate nohighlight">\(\gamma\)</span> and
excitation efficiency factor <span class="math notranslate nohighlight">\(\delta\)</span> are found performing a
linear fit to the equation</p>
<div class="math notranslate nohighlight">
\[S^{-1} = 1 + \beta\gamma + (1 - \gamma)\beta E\]</div>
<p>to the Gaussian mixture fit results, where <span class="math notranslate nohighlight">\(S\)</span> are the
components’ mean stoichiometries (corrected for leakage and direct
excitation) and <span class="math notranslate nohighlight">\(E\)</span> are the corresponding FRET efficiencies
(also corrected for leakage and direct excitation) <a class="reference internal" href="#hell2018" id="id11"><span>[Hell2018]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> (<em>int</em>) – Number of components for Gaussian mixture model</p></li>
<li><p><strong>components</strong> (<em>Sequence</em><em>[</em><em>int</em><em>] </em><em>| </em><em>None</em>) – List of indices of components to use for the linear fit. If <cite>None</cite>,
use all.</p></li>
<li><p><strong>random_seed</strong> (<em>int</em>) – Seed for the random number generator used to initialize the
Gaussian mixture model fit.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.fret.SmFRETAnalyzer.fret_correction">
<span class="sig-name descname"><span class="pre">fret_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invalid_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#SmFRETAnalyzer.fret_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.SmFRETAnalyzer.fret_correction" title="Permalink to this definition">#</a></dt>
<dd><p>Apply corrections to calculate real FRET-related values</p>
<p>By correcting the measured acceptor and donor intensities upon
donor excitation (<span class="math notranslate nohighlight">\(I_\text{DA}\)</span> and <span class="math notranslate nohighlight">\(I_\text{DD}\)</span>) and
acceptor intensity upon acceptor excitation (<span class="math notranslate nohighlight">\(I_\text{AA}\)</span>) for
donor leakage into the acceptor channel <span class="math notranslate nohighlight">\(\alpha\)</span>, acceptor
excitation by the donor laser <span class="math notranslate nohighlight">\(\delta\)</span>, detection efficiencies
<span class="math notranslate nohighlight">\(\gamma\)</span>, and excitation efficiencies <span class="math notranslate nohighlight">\(\beta\)</span>
using <a class="reference internal" href="#hell2018" id="id12"><span>[Hell2018]</span></a></p>
<div class="math notranslate nohighlight">
\[\begin{split}F_\text{DA} &amp;= I_\text{DA} - \alpha I_\text{DD} - \delta
I_\text{AA} \\
F_\text{DD} &amp;= \gamma I_\text{DD} \\
F_\text{AA} &amp;= I_\text{AA} / \beta\end{split}\]</div>
<p>the real FRET efficiency and stoichiometry values can be calculated:</p>
<div class="math notranslate nohighlight">
\[\begin{split}E &amp;= \frac{F_\text{DA}}{F_\text{DA} + F_\text{DD}} \\
S &amp;=  \frac{F_\text{DA} + F_\text{DD}}{F_\text{DA} + F_\text{DD} +
F_\text{AA}}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(F_\text{DA}\)</span> will be appended to <a class="reference internal" href="#sdt.fret.SmFRETAnalyzer.tracks" title="sdt.fret.SmFRETAnalyzer.tracks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tracks</span></code></a> as the
<code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;f_da&quot;)</span></code> column; <span class="math notranslate nohighlight">\(F_\text{DD}\)</span> as
<code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;f_dd&quot;)</span></code>; <span class="math notranslate nohighlight">\(F_\text{DA}\)</span> as <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;f_aa&quot;)</span></code>;
<span class="math notranslate nohighlight">\(E\)</span> as <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;eff&quot;)</span></code>; and <span class="math notranslate nohighlight">\(S\)</span> as <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span>
<span class="pre">&quot;stoi&quot;)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>invalid_nan</strong> (<em>bool</em>) – If True, all “eff”, and “stoi” values for excitation
types other than donor excitation are set to NaN, since the values
don’t make sense. Defaults to True.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="sdt.fret.smfret_scatter">
<span class="sig-prename descclassname"><span class="pre">sdt.fret.</span></span><span class="sig-name descname"><span class="pre">smfret_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">track_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('fret',</span> <span class="pre">'eff')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('fret',</span> <span class="pre">'stoi')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_plot.html#smfret_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.smfret_scatter" title="Permalink to this definition">#</a></dt>
<dd><p>Make scatter plots of multiple smFRET datasets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track_data</strong> (<em>dict</em><em> of </em><em>str: pandas.DataFrame</em>) – dict keys are used to identify the smFRET datasets (dict values).
The DataFrames have to have the same format as e.g. produced by
<a class="reference internal" href="#sdt.fret.SmFRETTracker" title="sdt.fret.SmFRETTracker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmFRETTracker</span></code></a>.</p></li>
<li><p><strong>x_data</strong> (<em>tuple</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Column indices of data to plot on the x (y) axis. Defaults to
<code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;eff&quot;)</span></code> for <cite>x_data</cite> and <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;stoi&quot;)</span></code> for
<cite>y_data</cite>.</p></li>
<li><p><strong>y_data</strong> (<em>tuple</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Column indices of data to plot on the x (y) axis. Defaults to
<code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;eff&quot;)</span></code> for <cite>x_data</cite> and <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;stoi&quot;)</span></code> for
<cite>y_data</cite>.</p></li>
<li><p><strong>frame</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If given, only plot data from a certain frame. Defaults to None.</p></li>
<li><p><strong>columns</strong> (<em>int</em><em>, </em><em>optional</em>) – In how many columns to lay out plots. Defaults to 2.</p></li>
<li><p><strong>size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size per plot. Defaults to 5.</p></li>
<li><p><strong>xlim</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Set x (y) axis limits. Defaults to <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code>, i.e. automatic
determination.</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Set x (y) axis limits. Defaults to <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code>, i.e. automatic
determination.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Label for x (y) axis. If <cite>None</cite>, use <cite>x_data</cite> (<cite>y_data</cite>). Defaults to
<cite>None</cite>.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Label for x (y) axis. If <cite>None</cite>, use <cite>x_data</cite> (<cite>y_data</cite>). Defaults to
<cite>None</cite>.</p></li>
<li><p><strong>scatter_args</strong> (<em>dict</em><em>, </em><em>optional</em>) – Further arguments to pass as keyword arguments to the scatter function.
Defaults to {}.</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to draw a grid in the plots. Defaults to True.</p></li>
<li><p><strong>ax</strong> (<em>array-like</em><em> of </em><em>matplotlib.axes.Axes</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Axes to use for plotting. If <cite>None</cite>, a new figure with axes is
created. Defaults to <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – figure object used for plotting</p></li>
<li><p><strong>ax</strong> (<em>numpy.ndarray of mpl.axes.Axes</em>) – axes objects of the plots</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sdt.fret.smfret_hist">
<span class="sig-prename descclassname"><span class="pre">sdt.fret.</span></span><span class="sig-name descname"><span class="pre">smfret_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">track_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('fret',</span> <span class="pre">'eff')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_re</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_plot.html#smfret_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.smfret_hist" title="Permalink to this definition">#</a></dt>
<dd><p>Make histogram plots of multiple smFRET datasets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track_data</strong> (<em>dict</em><em> of </em><em>str: pandas.DataFrame</em>) – dict keys are used to identify the smFRET datasets (dict values).
The DataFrames have to have the same format as e.g. produced by
<a class="reference internal" href="#sdt.fret.SmFRETTracker" title="sdt.fret.SmFRETTracker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmFRETTracker</span></code></a>.</p></li>
<li><p><strong>data</strong> (<em>tuple</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Column indices of data. Defaults to <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;eff&quot;)</span></code>.</p></li>
<li><p><strong>y_data</strong> (<em>tuple</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Column indices of data. Defaults to <code class="docutils literal notranslate"><span class="pre">(&quot;fret&quot;,</span> <span class="pre">&quot;eff&quot;)</span></code>.</p></li>
<li><p><strong>frame</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If given, only plot data from a certain frame. Defaults to None.</p></li>
<li><p><strong>columns</strong> (<em>int</em><em>, </em><em>optional</em>) – In how many columns to lay out plots. Defaults to 2.</p></li>
<li><p><strong>size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size per plot. Defaults to 5.</p></li>
<li><p><strong>xlim</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Set x axis limits. Defaults to <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code>, i.e. automatic
determination.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Label for x (y) axis. If <cite>None</cite>, use <cite>data</cite> for the x axis and
<code class="docutils literal notranslate"><span class="pre">&quot;#</span> <span class="pre">events&quot;</span></code> on the y axis. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Label for x (y) axis. If <cite>None</cite>, use <cite>data</cite> for the x axis and
<code class="docutils literal notranslate"><span class="pre">&quot;#</span> <span class="pre">events&quot;</span></code> on the y axis. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>group_re</strong> (<em>tuple</em><em>(</em><em>str</em><em>, </em><em>int</em><em>, </em><em>int</em><em>) or </em><em>None</em><em>, </em><em>optional</em>) – The first entry in the tuple should be a regular expression with at
least two groups. Datasets from <cite>track_data</cite> will be plotted in the
same plot if whichever regex group is specified by the second entry in
the tuple is the same. The third entry identifies the label of the
dataset in the plot. If None, do no grouping. Defaults to None.</p></li>
<li><p><strong>hist_args</strong> (<em>dict</em><em>, </em><em>optional</em>) – Further arguments to pass as keyword arguments to the histogram
plotting function. Defaults to {}.</p></li>
<li><p><strong>ax</strong> (<em>array-like</em><em> of </em><em>matplotlib.axes.Axes</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Axes to use for plotting. If <cite>None</cite>, a new figure with axes is
created. Defaults to <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – figure object used for plotting</p></li>
<li><p><strong>ax</strong> (<em>numpy.ndarray of mpl.axes.Axes</em>) – axes objects of the plots</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sdt.fret.draw_track">
<span class="sig-prename descclassname"><span class="pre">sdt.fret.</span></span><span class="sig-name descname"><span class="pre">draw_track</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">donor_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptor_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_plot.html#draw_track"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.draw_track" title="Permalink to this definition">#</a></dt>
<dd><p>Draw donor and acceptor images for a track</p>
<p>For each frame in a track, draw the raw image in the proximity of the
feature localization.</p>
<p>Note: This is rather slow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (<em>pandas.DataFrame</em>) – smFRET tracking data as e.g. produced by <a class="reference internal" href="#sdt.fret.SmFRETTracker" title="sdt.fret.SmFRETTracker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmFRETTracker</span></code></a></p></li>
<li><p><strong>track_no</strong> (<em>int</em>) – Track/particle number</p></li>
<li><p><strong>donor_img</strong> (<em>list-like</em><em> of </em><em>numpy.ndarray</em>) – Image sequences of the donor and acceptor channels</p></li>
<li><p><strong>acceptor_img</strong> (<em>list-like</em><em> of </em><em>numpy.ndarray</em>) – Image sequences of the donor and acceptor channels</p></li>
<li><p><strong>size</strong> (<em>int</em>) – For each feature, draw a square of <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">size</span> <span class="pre">+</span> <span class="pre">1</span></code> size pixels.</p></li>
<li><p><strong>n_cols</strong> (<em>int</em><em>, </em><em>optional</em>) – Arrange images in that many columns. Defaults to 8.</p></li>
<li><p><strong>figure</strong> (<em>matplotlib.figure.Figure</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Use this figure to draw. If <cite>None</cite>, use
<code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.gcf()</span></code>. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>columns</strong> (<em>dict</em><em>, </em><em>optional</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. The only relevant name is <cite>coords</cite>.
This means, if your DataFrame has coordinate columns “x” and “z”, set
<code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;]}</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The figure object used for plotting</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="helpers">
<h2>Helpers<a class="headerlink" href="#helpers" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="sdt.fret.numeric_exc_type">
<span class="sig-prename descclassname"><span class="pre">sdt.fret.</span></span><span class="sig-name descname"><span class="pre">numeric_exc_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/utils.html#numeric_exc_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.numeric_exc_type" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager temporarily turning (“fret”, “exc_type”) column to int</p>
<p>This is useful e.g. in <code class="xref py py-func docutils literal notranslate"><span class="pre">helper.split_dataframe()</span></code> so that the
resulting split array does not have <cite>object</cite> dtype due to
(“fret”, “exc_type”) being categorical.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tracks</span><span class="p">[</span><span class="s2">&quot;fret&quot;</span><span class="p">,</span> <span class="s2">&quot;exc_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">CategoricalDtype(categories=[&#39;a&#39;, &#39;d&#39;], ordered=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">numeric_exc_type</span><span class="p">(</span><span class="n">tracks</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_cats</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">tracks</span><span class="p">[</span><span class="s2">&quot;fret&quot;</span><span class="p">,</span> <span class="s2">&quot;exc_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;int64&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exc_cats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&quot;a&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">exc_cats</span></code> is an array that holds old categories. It can be used to find
out which (new) integer corresponds to which category</p>
<p>When leaving the <code class="docutils literal notranslate"><span class="pre">with</span></code> block, the old categorical column is restored.
This works only for the original DataFrame, but not for any copies made
within the block!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe for which to temporarily use an integer (“fret”, “exc_type”)
column.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pandas.Index</em> – Maps integers to categories</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sdt.fret.gaussian_mixture_split">
<span class="sig-prename descclassname"><span class="pre">sdt.fret.</span></span><span class="sig-name descname"><span class="pre">gaussian_mixture_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[('fret',</span> <span class="pre">'eff_app'),</span> <span class="pre">('fret',</span> <span class="pre">'stoi_app')]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#gaussian_mixture_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.gaussian_mixture_split" title="Permalink to this definition">#</a></dt>
<dd><p>Fit Gaussian mixture model and predict component for each particle</p>
<p>First, all datapoints are used to fit a Gaussian mixture model. Then each
particle is assigned the component in which most of its datapoints lie.</p>
<p>This requires scikit-learn (sklearn).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataFrame</em>) – Single-molecule FRET data</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of components in the mixture</p></li>
<li><p><strong>columns</strong> (<em>Sequence</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Which columns to fit.</p></li>
<li><p><strong>random_seed</strong> (<em>int</em>) – Seed for the random number generator used to initialize the Gaussian
mixture model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Component label for each entry in <cite>data</cite> and mean values for each</p></li>
<li><p><em>component, one line per component.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>ndarray</em>, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sdt.fret.apply_track_filters">
<span class="sig-prename descclassname"><span class="pre">sdt.fret.</span></span><span class="sig-name descname"><span class="pre">apply_track_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/fret/sm_analyzer.html#apply_track_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.fret.apply_track_filters" title="Permalink to this definition">#</a></dt>
<dd><p>Apply filters to <cite>tracks</cite></p>
<p>This removes all entries from <cite>tracks</cite> that have been marked
as filtered via a <code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_negative</strong> (<em>bool</em>) – If <cite>False</cite>, include only entries for which all <code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column
values are zero. If <cite>True</cite>, include also entries with negative
<code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column values.</p></li>
<li><p><strong>ignore</strong> (<em>str</em><em> | </em><em>Sequence</em><em>[</em><em>str</em><em>]</em>) – <code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column(s) to ignore when deciding whether to include an
entry or not. For instance, setting <code class="docutils literal notranslate"><span class="pre">ignore=&quot;bleach_step&quot;</span></code> will not
consider the <code class="docutils literal notranslate"><span class="pre">(&quot;filter&quot;,</span> <span class="pre">&quot;bleach_step&quot;)</span></code> column values.</p></li>
<li><p><strong>ret_type</strong> (<em>str</em>) – If <code class="docutils literal notranslate"><span class="pre">&quot;data&quot;</span></code>, return a copy of <cite>tracks</cite> excluding all entries that
have been marked as filtered, i.e., that have a positive (or nonzero,
see the <cite>include_negative</cite> parameter) entry in any <code class="docutils literal notranslate"><span class="pre">&quot;filter&quot;</span></code> column.
If <code class="docutils literal notranslate"><span class="pre">&quot;mask&quot;</span></code>, return a boolean array indicating whether an entry is to
be removed or not</p></li>
<li><p><strong>tracks</strong> (<em>DataFrame</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Copy of <cite>tracks</cite> with all filtered rows removed or corresponding boolean</p></li>
<li><p><em>mask.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em> | <em>array</em></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="hell2018" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Hell2018<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id4">2</a>,<a role="doc-backlink" href="#id5">3</a>,<a role="doc-backlink" href="#id6">4</a>,<a role="doc-backlink" href="#id7">5</a>,<a role="doc-backlink" href="#id8">6</a>,<a role="doc-backlink" href="#id11">7</a>,<a role="doc-backlink" href="#id12">8</a>)</span>
<p>Hellenkamp, B. et al.: “Precision and accuracy of
single-molecule FRET measurements—a multi-laboratory benchmark study”,
Nature methods, Nature Publishing Group, 2018, 15, 669</p>
</div>
<div class="citation" id="macc2010" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>MacC2010<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id9">2</a>)</span>
<p>McCann, J. J. et al.: “Optimizing Methods to Recover Absolute
FRET Efficiency from Immobilized Single Molecules” Biophysical Journal,
Elsevier BV, 2010, 99, 961–970</p>
</div>
<div class="citation" id="lee2005" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Lee2005<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id3">1</a>,<a role="doc-backlink" href="#id10">2</a>)</span>
<p>Lee, N. et al.: “Accurate FRET Measurements within Single
Diffusing Biomolecules Using Alternating-Laser Excitation”, Biophysical
Journal, Elsevier BV, 2005, 88, 2939–2953</p>
</div>
</div>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="spatial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Analyze spatial aspects of data</p>
      </div>
    </a>
    <a class="right-next"
       href="image.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Image filtering and processing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tracking">Tracking</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.frame_selector"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.frame_selector</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.registrator"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.registrator</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.link_options"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.link_options</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.min_length"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.min_length</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.brightness_options"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.brightness_options</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.interpolate"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.interpolate</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.coloc_dist"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.coloc_dist</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.acceptor_channel"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.acceptor_channel</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.columns"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.columns</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.neighbor_radius"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.neighbor_radius</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.excitation_seq"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.excitation_seq</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.track"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.track()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.flag_excitation_type"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.flag_excitation_type()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.to_yaml"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.to_yaml()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETTracker.from_yaml"><code class="docutils literal notranslate"><span class="pre">SmFRETTracker.from_yaml()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-filtering">Analysis and Filtering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.bleach_thresh"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.bleach_thresh</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.tracks"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.tracks</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.cp_detector"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.cp_detector</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.columns"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.columns</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.leakage"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.leakage</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.direct_excitation"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.direct_excitation</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.detection_eff"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.detection_eff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.excitation_eff"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.excitation_eff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.reset_filters"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.reset_filters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_fret_values"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_fret_values()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.apply_filters"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.apply_filters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.mass_changepoints"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.mass_changepoints()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.bleach_step"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.bleach_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.query"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.query()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.query_particles"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.query_particles()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.image_mask"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.image_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.flatfield_correction"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.flatfield_correction()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_leakage"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_leakage()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_direct_excitation"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_direct_excitation()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_detection_eff"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_detection_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_excitation_eff"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_excitation_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.calc_detection_excitation_effs"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.calc_detection_excitation_effs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.SmFRETAnalyzer.fret_correction"><code class="docutils literal notranslate"><span class="pre">SmFRETAnalyzer.fret_correction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting">Plotting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.smfret_scatter"><code class="docutils literal notranslate"><span class="pre">smfret_scatter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.smfret_hist"><code class="docutils literal notranslate"><span class="pre">smfret_hist()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.draw_track"><code class="docutils literal notranslate"><span class="pre">draw_track()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#helpers">Helpers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.numeric_exc_type"><code class="docutils literal notranslate"><span class="pre">numeric_exc_type()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.gaussian_mixture_split"><code class="docutils literal notranslate"><span class="pre">gaussian_mixture_split()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.fret.apply_track_filters"><code class="docutils literal notranslate"><span class="pre">apply_track_filters()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lukas Schrangl
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2015—2023, Lukas Schrangl.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>