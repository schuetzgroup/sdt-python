

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Flat-field correction &#8212; sdt-python 18.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'flatfield';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fluorescent feature localization" href="loc.html" />
    <link rel="prev" title="Image filtering and processing" href="image.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">sdt-python 18.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="roi.html">Regions of interest (ROIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multicolor.html">Multi-color data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="motion.html">Diffusion analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="brightness.html">Brightness analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Data input/output</a></li>
<li class="toctree-l1"><a class="reference internal" href="changepoint.html">Changepoint detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatial.html">Analyze spatial aspects of data</a></li>
<li class="toctree-l1"><a class="reference internal" href="fret.html">Single molecule FRET analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Image filtering and processing</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Flat-field correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="loc.html">Fluorescent feature localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbui.html">GUIs for the Jupyter notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="sim.html">Simulation of microscopy-related data</a></li>
<li class="toctree-l1"><a class="reference internal" href="funcs.html">Special functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot.html">Plotting utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimize.html">Optimization and fitting algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="helper.html">Helpers for writing new code</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Change log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/schuetzgroup/sdt-python" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/flatfield.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Flat-field correction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#programming-reference">Programming reference</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector"><code class="docutils literal notranslate"><span class="pre">Corrector</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.bg"><code class="docutils literal notranslate"><span class="pre">Corrector.bg</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.avg_img"><code class="docutils literal notranslate"><span class="pre">Corrector.avg_img</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.fit_result"><code class="docutils literal notranslate"><span class="pre">Corrector.fit_result</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.corr_img"><code class="docutils literal notranslate"><span class="pre">Corrector.corr_img</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.fit_amplitude"><code class="docutils literal notranslate"><span class="pre">Corrector.fit_amplitude</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.__call__"><code class="docutils literal notranslate"><span class="pre">Corrector.__call__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.get_factors"><code class="docutils literal notranslate"><span class="pre">Corrector.get_factors()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.save"><code class="docutils literal notranslate"><span class="pre">Corrector.save()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.load"><code class="docutils literal notranslate"><span class="pre">Corrector.load()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <span class="target" id="module-sdt.flatfield"></span><section id="flat-field-correction">
<h1>Flat-field correction<a class="headerlink" href="#flat-field-correction" title="Permalink to this heading">#</a></h1>
<p>The intensity cross section of a laser beam is usually not flat, but of
Gaussian shape or worse. That means that fluorophores closer to the edges of
the image will appear dimmer simply because they do not receive so much
exciting laser light.</p>
<p>A camera’s pixels may differ in efficiency so that even a homogeneously
illuminated sample will not look homogeneous.</p>
<p>Errors as these can corrected for to some extent by <em>flat-field correction</em>.
The error is determined by recording a supposedly homogeneous (flat) sample
(e.g. a homogeneously fluorescent surface) and can later be removed from
other/real experimental data.</p>
<p class="rubric">Examples</p>
<p>First, load images that show the error, e.g. images of a surface with
homogenous fluorescence label.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">baseline</span> <span class="o">=</span> <span class="mf">200.</span>  <span class="c1"># camera baseline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load homogenous sample image sequences</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">ImageSequence</span><span class="p">(</span><span class="s2">&quot;flat1.tif&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">ImageSequence</span><span class="p">(</span><span class="s2">&quot;flat2.tif&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</pre></div>
</div>
<p>These can now be used to create the <a class="reference internal" href="#sdt.flatfield.Corrector" title="sdt.flatfield.Corrector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Corrector</span></code></a> object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">Corrector</span><span class="p">([</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">],</span> <span class="n">bg</span><span class="o">=</span><span class="n">baseline</span><span class="p">)</span>
</pre></div>
</div>
<p>With help of <code class="docutils literal notranslate"><span class="pre">corr</span></code>, other images or even whole image sequences (when using
<code class="xref py py-class docutils literal notranslate"><span class="pre">io.ImageSequence</span></code> to load them) can now be corrected.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">ImageSequence</span><span class="p">(</span><span class="s2">&quot;experiment_data.tif&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3_flat</span> <span class="o">=</span> <span class="n">corr</span><span class="p">(</span><span class="n">img3</span><span class="p">)</span>
</pre></div>
</div>
<p>The brightness values of single molecule data may be corrected as well:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sm_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;data.h5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sm_data_flat</span> <span class="o">=</span> <span class="n">corr</span><span class="p">(</span><span class="n">sm_data</span><span class="p">)</span>
</pre></div>
</div>
<section id="programming-reference">
<h2>Programming reference<a class="headerlink" href="#programming-reference" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sdt.flatfield.</span></span><span class="sig-name descname"><span class="pre">Corrector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/flatfield.html#Corrector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.flatfield.Corrector" title="Permalink to this definition">#</a></dt>
<dd><p>Flat field correction</p>
<p>This works by multiplying features’ integrated intensities (“mass”) by
a position-dependent correction factor. The factor can be calculated from
a series of images of a fluorescent surface or from single molecule data.</p>
<p>The factor is calculated in case of a fluorescent surface by</p>
<ul class="simple">
<li><p>Taking the averages of the pixel intensities of the images</p></li>
<li><p>If requested, doing a 2D Gaussian fit</p></li>
<li><p>Normalizing, so that the maximum of the Gaussian or of the average image
(if on Gaussian fit was performed) equals 1.0</p></li>
</ul>
<p>or in the case of single molecule data by fitting a 2D Gaussian to their
“mass” values. Single molecule density fluctuations are take into account
by weighing data points inversely to their density in the fit.</p>
<p>The “signal” and “mass” of a feature at position (x, y) are then divided by
the value of the Gaussian at the positon (x, y) (or the pixel intensity of
the image) to yield a corrected value. Also, image data can be corrected
analogously in a pixel-by-pixel fashion.</p>
<p><strong>Images (both for deterimnation of the correction and those to be
corrected) need to have their background subtracted for this to work
properly.</strong> This can be done by telling the <cite>Corrector</cite> object what the
background is (or of course, before passing the data to the <cite>Corrector</cite>.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em><em> | </em><em>Sequence</em><em>[</em><em>ndarray</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>ndarray</em><em>]</em><em>] </em><em>| </em><em>DataFrame</em><em> | </em><em>Sequence</em><em>[</em><em>DataFrame</em><em>]</em>) – Collections of images fluorescent surfaces or single molecule
data to use for determining the correction function.</p></li>
<li><p><strong>bg</strong> (<em>float</em><em> | </em><em>numpy.ndarray</em>) – Background that is subtracted from each image. It is not used on
single molecule data. Also sets the :py:attr`bg` attribute.</p></li>
<li><p><strong>gaussian_fit</strong> (<em>bool</em>) – Whether to fit a Gaussian to the averaged image. This is ignored
if <cite>data</cite> is single molecule data.</p></li>
<li><p><strong>shape</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em>) – If <cite>data</cite> is single molecule data, use this to specify the height
and width (in this order) of the image region. It allows for
calculation of the correct normalization in case the maximum of
the fitted Gaussian does not lie within the region. Furthermore,
<a class="reference internal" href="#sdt.flatfield.Corrector.avg_img" title="sdt.flatfield.Corrector.avg_img"><code class="xref py py-attr docutils literal notranslate"><span class="pre">avg_img</span></code></a> and <a class="reference internal" href="#sdt.flatfield.Corrector.corr_img" title="sdt.flatfield.Corrector.corr_img"><code class="xref py py-attr docutils literal notranslate"><span class="pre">corr_img</span></code></a> can be created from the
fit.</p></li>
<li><p><strong>density_weight</strong> (<em>bool</em>) – If <cite>data</cite> is single molecule data, weigh data points inversely to
their density for fitting so that areas with higher densities don’t
have a higher impact on the result.</p></li>
<li><p><strong>smooth_sigma</strong> (<em>float</em>) – If &gt; 0, smooth the image used for flatfield correction. Only
applicable if <code class="docutils literal notranslate"><span class="pre">gaussian_fit=False</span></code>.</p></li>
<li><p><strong>columns</strong> (<em>Dict</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. Only applicable of <cite>data</cite> are single
molecule DataFrames. The relevant names are <cite>coords</cite> and <cite>mass</cite>.
That means, if the DataFrames have coordinate columns “x” and “z”
and a mass column “alt_mass”, set
<code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;],</span> <span class="pre">&quot;mass&quot;:</span> <span class="pre">&quot;alt_mass&quot;}</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.bg">
<span class="sig-name descname"><span class="pre">bg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#sdt.flatfield.Corrector.bg" title="Permalink to this definition">#</a></dt>
<dd><p>Background to be subtracted from image data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.avg_img">
<span class="sig-name descname"><span class="pre">avg_img</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#sdt.flatfield.Corrector.avg_img" title="Permalink to this definition">#</a></dt>
<dd><p>Pixel-wise average image from <cite>data</cite> argument to <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.fit_result">
<span class="sig-name descname"><span class="pre">fit_result</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sdt.flatfield.Corrector.fit_result" title="Permalink to this definition">#</a></dt>
<dd><p>If a Gaussian fit was done, this holds the result. Otherwise, it is
<cite>None</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.corr_img">
<span class="sig-name descname"><span class="pre">corr_img</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#sdt.flatfield.Corrector.corr_img" title="Permalink to this definition">#</a></dt>
<dd><p>Pixel data used for correction of images. Any image to be corrected
is divided pixel-wise by <cite>corr_img</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.fit_amplitude">
<span class="sig-name descname"><span class="pre">fit_amplitude</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sdt.flatfield.Corrector.fit_amplitude" title="Permalink to this definition">#</a></dt>
<dd><p>If a Gaussian fit was done, this holds the maximum of the Gaussian
within the image region. See also the <cite>shape</cite> argument to the constructor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/flatfield.html#Corrector.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.flatfield.Corrector.__call__" title="Permalink to this definition">#</a></dt>
<dd><p>Do brightness correction on <cite>features</cite> intensities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataFrame</em><em> | </em><a class="reference internal" href="helper.html#sdt.helper.Slicerator" title="sdt.helper.slicerator.Slicerator"><em>Slicerator</em></a><em> | </em><em>ndarray</em>) – data to be processed. If a pandas.Dataframe, correct the “mass”
column according to the particle position in the laser beam.
Otherwise, <code class="xref py py-class docutils literal notranslate"><span class="pre">pipeline</span></code> is used to correct raw image data.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – Only has an effect if <cite>data</cite> is a DataFrame. If True, the
feature intensities will be corrected in place.</p></li>
<li><p><strong>bg</strong> (<em>float</em><em> | </em><em>ndarray</em><em> | </em><em>None</em>) – Background to be subtracted from image data. If <cite>None</cite>, use the
<a class="reference internal" href="#sdt.flatfield.Corrector.bg" title="sdt.flatfield.Corrector.bg"><code class="xref py py-attr docutils literal notranslate"><span class="pre">bg</span></code></a> attribute. Ignored for single molecule data.</p></li>
<li><p><strong>columns</strong> (<em>dict</em><em>, </em><em>optional</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. Only applicable of <cite>data</cite> are single
molecule DataFrames. The relevant names are <cite>coords</cite>, <cite>signal</cite>, and
<cite>mass</cite>. That means, if the DataFrames have coordinate columns “x”
and “z” and a mass column “alt_mass”, set
<code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;],</span> <span class="pre">&quot;mass&quot;:</span> <span class="pre">&quot;alt_mass&quot;}</span></code>.
It is also possible to give a list of columns to correct by adding
the “corr” key, e.g. <code class="docutils literal notranslate"><span class="pre">columns={&quot;corr&quot;:</span> <span class="pre">[&quot;mass&quot;,</span> <span class="pre">&quot;alt_mass&quot;]}</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>If <cite>data</cite> is a DataFrame and <cite>inplace</cite> is False, return the</p></li>
<li><p>corrected frame. If <cite>data</cite> is raw image data, return corrected</p></li>
<li><p><em>images</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em> | <a class="reference internal" href="helper.html#sdt.helper.Slicerator" title="sdt.helper.slicerator.Slicerator"><em>Slicerator</em></a> | <em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.get_factors">
<span class="sig-name descname"><span class="pre">get_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/flatfield.html#Corrector.get_factors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.flatfield.Corrector.get_factors" title="Permalink to this definition">#</a></dt>
<dd><p>Get correction factors at positions x, y</p>
<p>Depending on whether gaussian_fit was set to True or False in the
constructor, the correction factors for each feature that described by
an x and a y coordinate is calculated either from the Gaussian fit
or the average image itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – x and y coordinates of features</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – x and y coordinates of features</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D array of correction factors corresponding to the features</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/flatfield.html#Corrector.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.flatfield.Corrector.save" title="Permalink to this definition">#</a></dt>
<dd><p>Save instance to disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em> | </em><em>Path</em><em> | </em><em>BinaryIO</em>) – Where to save. If <cite>str</cite>, the extension “.npz” will be appended if
it is not present.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.flatfield.Corrector.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/flatfield.html#Corrector.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.flatfield.Corrector.load" title="Permalink to this definition">#</a></dt>
<dd><p>Load from disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em> | </em><em>Path</em><em> | </em><em>BinaryIO</em>) – Where to load from</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded instance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#sdt.flatfield.Corrector" title="sdt.flatfield.Corrector">sdt.flatfield.Corrector</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="image.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Image filtering and processing</p>
      </div>
    </a>
    <a class="right-next"
       href="loc.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluorescent feature localization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#programming-reference">Programming reference</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector"><code class="docutils literal notranslate"><span class="pre">Corrector</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.bg"><code class="docutils literal notranslate"><span class="pre">Corrector.bg</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.avg_img"><code class="docutils literal notranslate"><span class="pre">Corrector.avg_img</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.fit_result"><code class="docutils literal notranslate"><span class="pre">Corrector.fit_result</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.corr_img"><code class="docutils literal notranslate"><span class="pre">Corrector.corr_img</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.fit_amplitude"><code class="docutils literal notranslate"><span class="pre">Corrector.fit_amplitude</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.__call__"><code class="docutils literal notranslate"><span class="pre">Corrector.__call__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.get_factors"><code class="docutils literal notranslate"><span class="pre">Corrector.get_factors()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.save"><code class="docutils literal notranslate"><span class="pre">Corrector.save()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.flatfield.Corrector.load"><code class="docutils literal notranslate"><span class="pre">Corrector.load()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lukas Schrangl
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2015—2023, Lukas Schrangl.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>