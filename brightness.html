

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Brightness analysis &#8212; sdt-python 18.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'brightness';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data input/output" href="io.html" />
    <link rel="prev" title="Diffusion analysis" href="motion.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">sdt-python 18.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="roi.html">Regions of interest (ROIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multicolor.html">Multi-color data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="motion.html">Diffusion analysis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Brightness analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Data input/output</a></li>
<li class="toctree-l1"><a class="reference internal" href="changepoint.html">Changepoint detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatial.html">Analyze spatial aspects of data</a></li>
<li class="toctree-l1"><a class="reference internal" href="fret.html">Single molecule FRET analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Image filtering and processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="flatfield.html">Flat-field correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="loc.html">Fluorescent feature localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbui.html">GUIs for the Jupyter notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="sim.html">Simulation of microscopy-related data</a></li>
<li class="toctree-l1"><a class="reference internal" href="funcs.html">Special functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot.html">Plotting utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimize.html">Optimization and fitting algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="helper.html">Helpers for writing new code</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Change log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/schuetzgroup/sdt-python" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/brightness.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Brightness analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#programming-reference">Programming reference</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.from_raw_image"><code class="docutils literal notranslate"><span class="pre">from_raw_image()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution"><code class="docutils literal notranslate"><span class="pre">Distribution</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.graph"><code class="docutils literal notranslate"><span class="pre">Distribution.graph</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.num_data"><code class="docutils literal notranslate"><span class="pre">Distribution.num_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.mean"><code class="docutils literal notranslate"><span class="pre">Distribution.mean()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.std"><code class="docutils literal notranslate"><span class="pre">Distribution.std()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.most_probable"><code class="docutils literal notranslate"><span class="pre">Distribution.most_probable()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.mode"><code class="docutils literal notranslate"><span class="pre">Distribution.mode()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.plot"><code class="docutils literal notranslate"><span class="pre">Distribution.plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <span class="target" id="module-sdt.brightness"></span><section id="brightness-analysis">
<h1>Brightness analysis<a class="headerlink" href="#brightness-analysis" title="Permalink to this heading">#</a></h1>
<p>This is a collection of tools to analyze the brightness of fluorophores. It
offers</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="#sdt.brightness.from_raw_image" title="sdt.brightness.from_raw_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_raw_image()</span></code></a> function which may be used to calculate the
brightness of single molecules by extracting the information directly from
the raw image data.</p></li>
<li><p>The <a class="reference internal" href="#sdt.brightness.Distribution" title="sdt.brightness.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a> class, with which one can determine the
brightness distribution of fluorophores via kernel density estimation.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>To determine single molecule brightness using <a class="reference internal" href="#sdt.brightness.from_raw_image" title="sdt.brightness.from_raw_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_raw_image()</span></code></a>, one
needs the raw image data and localization data of molecules (which can be
determined from the image date e.g. using functionality from the
<a class="reference internal" href="loc.html#module-0" title="sdt.loc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sdt.loc</span></code></a> module):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span> <span class="o">=</span> <span class="n">sdt</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;localizations.h5&quot;</span><span class="p">)</span>  <span class="c1"># Load single molecule localizations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">ImageSequence</span><span class="p">(</span><span class="s2">&quot;images.tif&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">img_seq</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">from_raw_image</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">img_seq</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The last line updates the <code class="docutils literal notranslate"><span class="pre">loc</span></code> DataFrame with the brightness data extracted
from the raw image.</p>
<p>The distribution of the brightness of single molecules can be calculated
by means of the <a class="reference internal" href="#sdt.brightness.Distribution" title="sdt.brightness.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a> class:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span> <span class="o">=</span> <span class="p">[</span><span class="n">sdt</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.h5&quot;</span><span class="p">)]</span>  <span class="c1"># Load sm data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cam_eff</span> <span class="o">=</span> <span class="mi">300</span> <span class="o">/</span> <span class="mf">15.7</span>  <span class="c1"># number of camera counts per photon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bdist</span> <span class="o">=</span> <span class="n">Distribution</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">cam_eff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bdist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">314.1592653589793</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bdist</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="go">31.41592653589793</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bdist</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<section id="programming-reference">
<h2>Programming reference<a class="headerlink" href="#programming-reference" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="sdt.brightness.from_raw_image">
<span class="sig-prename descclassname"><span class="pre">sdt.brightness.</span></span><span class="sig-name descname"><span class="pre">from_raw_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numba'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'square'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/brightness.html#from_raw_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.brightness.from_raw_image" title="Permalink to this definition">#</a></dt>
<dd><p>Determine particle brightness by counting pixel values</p>
<p>Around each localization, pixel values are summed up (see the <cite>mask</cite>
parameter) to determine the brightness (mass). Additionally, local
background is determined by calculating the brightness (see <cite>bg_estimator</cite>
parameter in a frame (again, see <cite>mask</cite> parameter) around this box,
where all pixels belonging to any localization are excluded. This
background is subtracted from the signal brightness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>pandas.DataFrame</em>) – Localization data. “signal”, “mass”, “bg”, and “bg_dev”
columns are added and/or replaced directly in this object.</p></li>
<li><p><strong>frames</strong> (<em>iterable</em><em> of </em><em>numpy.ndarrays</em>) – Raw image data</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – Half width of the box in which pixel values are summed up. See <cite>mask</cite>
parameter for details.</p></li>
<li><p><strong>bg_frame</strong> (<em>int</em><em> or </em><em>infinity</em><em>, </em><em>optional</em>) – Width of frame (in pixels) around a feature for background
determination. If infinity, background is calculated globally from all
pixels that are not part of any feature. Defaults to 2.</p></li>
<li><p><strong>bg_estimator</strong> (<em>{&quot;mean&quot;</em><em>, </em><em>&quot;median&quot;}</em><em> or </em><em>numpy ufunc</em><em>, </em><em>optional</em>) – How to determine the background from the background pixels. “mean”
will use <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.mean()</span></code> and “median” will use
<code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.median()</span></code>. If a function is given (which takes the
pixel data as arguments and returns a scalar), apply this to the
pixels. Defaults to “mean”.</p></li>
<li><p><strong>mask</strong> (<em>{&quot;square&quot;</em><em>, </em><em>&quot;circle&quot;}</em><em> or </em><em>(</em><em>array-like</em><em>, </em><em>array-like</em><em>)</em><em>, </em><em>optional</em>) – If “square”, sum pixels in a <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">radius</span> <span class="pre">+</span> <span class="pre">1</span></code> sized square around
each localization as the brightness and use <cite>bg_estimator</cite> in a frame
of <cite>bg_frame</cite> width around it to determine the local background, which
is subtracted from the brightness. If “circle”, sum pixels in a
<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">radius</span> <span class="pre">+</span> <span class="pre">1</span></code> sized circle (a <code class="xref py py-class docutils literal notranslate"><span class="pre">CircleMask</span></code>
with radius <cite>radius</cite> and <code class="docutils literal notranslate"><span class="pre">extra=0.5</span></code> is used) around each
localization and get the background from an annulus of width
<code class="docutils literal notranslate"><span class="pre">bg_frame</span></code>. One can also pass a tuple <code class="docutils literal notranslate"><span class="pre">(feat_mask,</span> <span class="pre">bg_mask)</span></code> of
boolean arrays for brightness and background detection. In this case,
<cite>radius</cite> and <cite>bg_frame</cite> are ignored. If <cite>bg_mask</cite> is None, calculate
background globally (per frame) from all pixels that are not
part of any feature. In all cases, all pixels belonging
to any signal are automatically excluded from the background detection.
Defaults to “square”.</p></li>
<li><p><strong>columns</strong> (<em>dict</em><em>, </em><em>optional</em>) – Override default column names as defined in <code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>.
Relevant names are <cite>coords</cite>, <cite>time</cite>, <cite>mass</cite>, <cite>signal</cite>, <cite>bg</cite>, <cite>bg_dev</cite>.
This means, if your DataFrame has coordinate columns “x” and “z” and
the time column “alt_frame”, set <code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;],</span>
<span class="pre">&quot;time&quot;:</span> <span class="pre">&quot;alt_frame&quot;}</span></code>.</p></li>
<li><p><strong>engine</strong> (<em>{&quot;numba&quot;</em><em>, </em><em>&quot;python&quot;}</em><em>, </em><em>optional</em>) – Numba is faster, but only supports 2D data and mean or median
bg_estimator. If numba cannot be used, automatically fall back to
pure python, which support arbitray dimensions and bg_estimator
functions. Defaults to “numba”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sdt.brightness.Distribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sdt.brightness.</span></span><span class="sig-name descname"><span class="pre">Distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abscissa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cam_eff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kern_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numba'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/brightness.html#Distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.brightness.Distribution" title="Permalink to this definition">#</a></dt>
<dd><p>Brightness distribution of fluorescent signals</p>
<p>Given a list of peak masses (integrated intensities), calculate the
masses’ probability density function.</p>
<p>This is a Gaussian KDE with variable bandwith. See the <cite>bw</cite> parameter
documentation for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em><em> of </em><em>pandas.DataFrame</em><em> or </em><em>pandas.DataFrame</em><em> or </em><em>numpy.ndarray</em>) – If a DataFrame is given, extract the masses from the “mass” column.
A list of DataFrames will be concatenated. Brightness values can
also be passed as an one-dimensional ndarray.</p></li>
<li><p><strong>abscissa</strong> (<em>None</em><em> or </em><em>numpy.ndarray</em><em> or </em><em>float</em>) – The abscissa (x axis) values for the calculated distribution.
Providing a float is equivalent to <code class="docutils literal notranslate"><span class="pre">numpy.arange(abscissa</span> <span class="pre">+</span> <span class="pre">1)</span></code>.
If <cite>None</cite>, automatically choose something appropriate based on the
values of <cite>data</cite> and the bandwidth.</p></li>
<li><p><strong>bw</strong> (<em>float</em><em>, </em><em>optional</em>) – Bandwidth factor. The bandwidth for each data point <code class="docutils literal notranslate"><span class="pre">d</span></code> is
calculated as <code class="docutils literal notranslate"><span class="pre">bw</span> <span class="pre">*</span> <span class="pre">np.sqrt(d)</span></code>. Defaults to 2.</p></li>
<li><p><strong>cam_eff</strong> (<em>float</em><em>, </em><em>optional</em>) – Camera efficiency, i. e. how many camera counts correspond to one
photon. The brightness data will be divided by this number.
Defaults to 1.</p></li>
<li><p><strong>kern_width</strong> (<em>float</em><em>, </em><em>optional</em>) – Calculate kernels only in the range of +/- <cite>kern_width</cite> times the
bandwidth to save computation time. Defaults to 5.</p></li>
<li><p><strong>engine</strong> (<em>{&quot;numba&quot;</em><em>, </em><em>&quot;python&quot;}</em><em>, </em><em>optional</em>) – Whether to use the faster numba-based implementation or the slower
pure python one. Defaults to “numba”.</p></li>
<li><p><strong>columns</strong> (<em>dict</em><em>, </em><em>optional</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. The only relevant name is <cite>mass</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.brightness.Distribution.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#sdt.brightness.Distribution.graph" title="Permalink to this definition">#</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of shape (2, n); First row is the
abscissa, second row is the ordinate of the normalized distribution
function.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.brightness.Distribution.num_data">
<span class="sig-name descname"><span class="pre">num_data</span></span><a class="headerlink" href="#sdt.brightness.Distribution.num_data" title="Permalink to this definition">#</a></dt>
<dd><p>Number of data points (single molecules) used to create the
distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.brightness.Distribution.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/brightness.html#Distribution.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.brightness.Distribution.mean" title="Permalink to this definition">#</a></dt>
<dd><p>Mean</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mean (1st moment) of the distribution</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.brightness.Distribution.std">
<span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/brightness.html#Distribution.std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.brightness.Distribution.std" title="Permalink to this definition">#</a></dt>
<dd><p>Standard deviation</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Standard deviation (square root of the 2nd central moment) of the
distribution</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.brightness.Distribution.most_probable">
<span class="sig-name descname"><span class="pre">most_probable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/brightness.html#Distribution.most_probable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.brightness.Distribution.most_probable" title="Permalink to this definition">#</a></dt>
<dd><p>Most probable value (mode)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Most probable brightness (brightness value were the distribution
function has its maximum)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.brightness.Distribution.mode">
<span class="sig-name descname"><span class="pre">mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sdt.brightness.Distribution.mode" title="Permalink to this definition">#</a></dt>
<dd><p>Most probable value (mode)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Most probable brightness (brightness value were the distribution
function has its maximum)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.brightness.Distribution.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/brightness.html#Distribution.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.brightness.Distribution.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot the distribution function graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Axes to draw on. If <cite>None</cite>, use <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.gca()</span></code>.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>label</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Label for the legend. Defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="motion.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Diffusion analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="io.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data input/output</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#programming-reference">Programming reference</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.from_raw_image"><code class="docutils literal notranslate"><span class="pre">from_raw_image()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution"><code class="docutils literal notranslate"><span class="pre">Distribution</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.graph"><code class="docutils literal notranslate"><span class="pre">Distribution.graph</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.num_data"><code class="docutils literal notranslate"><span class="pre">Distribution.num_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.mean"><code class="docutils literal notranslate"><span class="pre">Distribution.mean()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.std"><code class="docutils literal notranslate"><span class="pre">Distribution.std()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.most_probable"><code class="docutils literal notranslate"><span class="pre">Distribution.most_probable()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.mode"><code class="docutils literal notranslate"><span class="pre">Distribution.mode()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.brightness.Distribution.plot"><code class="docutils literal notranslate"><span class="pre">Distribution.plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lukas Schrangl
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2015—2023, Lukas Schrangl.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>