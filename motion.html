

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Diffusion analysis &#8212; sdt-python 18.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'motion';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Brightness analysis" href="brightness.html" />
    <link rel="prev" title="Multi-color data analysis" href="multicolor.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">sdt-python 18.0 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="roi.html">Regions of interest (ROIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multicolor.html">Multi-color data analysis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Diffusion analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="brightness.html">Brightness analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Data input/output</a></li>
<li class="toctree-l1"><a class="reference internal" href="changepoint.html">Changepoint detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatial.html">Analyze spatial aspects of data</a></li>
<li class="toctree-l1"><a class="reference internal" href="fret.html">Single molecule FRET analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Image filtering and processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="flatfield.html">Flat-field correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="loc.html">Fluorescent feature localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbui.html">GUIs for the Jupyter notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="sim.html">Simulation of microscopy-related data</a></li>
<li class="toctree-l1"><a class="reference internal" href="funcs.html">Special functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot.html">Plotting utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimize.html">Optimization and fitting algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="helper.html">Helpers for writing new code</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Change log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/schuetzgroup/sdt-python" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/motion.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Diffusion analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#msd-calculation">MSD calculation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd"><code class="docutils literal notranslate"><span class="pre">Msd</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.Result"><code class="docutils literal notranslate"><span class="pre">Msd.Result</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.Result.msd"><code class="docutils literal notranslate"><span class="pre">Msd.Result.msd</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.Result.msd_err"><code class="docutils literal notranslate"><span class="pre">Msd.Result.msd_err</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.get_msd"><code class="docutils literal notranslate"><span class="pre">Msd.get_msd()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.fit"><code class="docutils literal notranslate"><span class="pre">Msd.fit()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist"><code class="docutils literal notranslate"><span class="pre">MsdDist</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result.msd"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result.msd</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result.msd_err"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result.msd_err</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result.weight"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result.weight</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result.weight_err"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result.weight_err</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.get_msd"><code class="docutils literal notranslate"><span class="pre">MsdDist.get_msd()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.fit"><code class="docutils literal notranslate"><span class="pre">MsdDist.fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-models-for-fitting">Diffusion models for fitting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.exposure_time_corr"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.exposure_time_corr()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.theoretical"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.theoretical()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.Result"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.Result</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.Result.fit"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.Result.fit</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.Result.fit_err"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.Result.fit_err</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.get_results"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.get_results()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.plot"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.plot()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.BrownianMotion"><code class="docutils literal notranslate"><span class="pre">BrownianMotion</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.BrownianMotion.theoretical"><code class="docutils literal notranslate"><span class="pre">BrownianMotion.theoretical()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#immobilization-detection">Immobilization detection</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.find_immobilizations"><code class="docutils literal notranslate"><span class="pre">find_immobilizations()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.label_mobile"><code class="docutils literal notranslate"><span class="pre">label_mobile()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.find_immobilizations_int"><code class="docutils literal notranslate"><span class="pre">find_immobilizations_int()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <span class="target" id="module-sdt.motion"></span><section id="diffusion-analysis">
<h1>Diffusion analysis<a class="headerlink" href="#diffusion-analysis" title="Permalink to this heading">#</a></h1>
<p>The <a class="reference internal" href="#module-sdt.motion" title="sdt.motion"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sdt.motion</span></code></a> module provides tools for analyzing single molecule
tracking data.</p>
<ul class="simple">
<li><p>Calculate mean square displacements (MSDs). This can be done directly
(<a class="reference internal" href="#sdt.motion.Msd" title="sdt.motion.Msd"><code class="xref py py-class docutils literal notranslate"><span class="pre">Msd</span></code></a>) or by fitting a multi-exponential model to the distribution
of square displacements (<a class="reference internal" href="#sdt.motion.MsdDist" title="sdt.motion.MsdDist"><code class="xref py py-class docutils literal notranslate"><span class="pre">MsdDist</span></code></a>). The latter allows for
identification of sub-components with different diffusion constants.</p></li>
<li><p>Fit diffusion models to the MSD data to get quantitative results using
<a class="reference internal" href="#sdt.motion.Msd.fit" title="sdt.motion.Msd.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Msd.fit()</span></code></a> or <a class="reference internal" href="#sdt.motion.MsdDist.fit" title="sdt.motion.MsdDist.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MsdDist.fit()</span></code></a>.</p></li>
<li><p>Plot results.</p></li>
<li><p>Find immobilized parts of trajectories using <a class="reference internal" href="#sdt.motion.find_immobilizations" title="sdt.motion.find_immobilizations"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_immobilizations()</span></code></a>.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>First, load some tracking data</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trc</span> <span class="o">=</span> <span class="n">sdt</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;tracks.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the esemble (i.e., pool all data from all tracks) MSD. Use 1000 runs
of bootstrapping to calculate error bars.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Msd</span><span class="p">(</span><span class="n">trc</span><span class="p">,</span> <span class="n">frame_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">pixel_size</span><span class="o">=</span><span class="mf">0.16</span><span class="p">,</span> <span class="n">n_lag</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msd</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_msd</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msd</span>
<span class="go">lagt</span>
<span class="go">0.1    0.028557</span>
<span class="go">0.2    0.054788</span>
<span class="go">0.3    0.083447</span>
<span class="go">0.4    0.113715</span>
<span class="go">0.5    0.142936</span>
<span class="go">Name: ensemble, dtype: float64</span>
</pre></div>
</div>
<p>Fit Brownian motion to the MSD data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="s2">&quot;brownian&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">,</span> <span class="n">fit_err</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span>
<span class="go">D      0.065576</span>
<span class="go">eps    0.020269</span>
<span class="go">Name: ensemble, dtype: float64</span>
</pre></div>
</div>
<p>An MSD plot can be created using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bm</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>To calculate MSDs and fit results for each particle individually, set
<code class="docutils literal notranslate"><span class="pre">ensemble=False</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span> <span class="o">=</span> <span class="n">Msd</span><span class="p">(</span><span class="n">trc</span><span class="p">,</span> <span class="n">frame_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ensemble</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pixel_size</span><span class="o">=</span><span class="mf">0.16</span><span class="p">,</span> <span class="n">n_lag</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msd2</span><span class="p">,</span> <span class="n">err2</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">get_msd</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msd2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">lagt           0.1       0.2       0.3       0.4       0.5</span>
<span class="go">particle</span>
<span class="go">0         0.034462  0.069578  0.096958  0.112310  0.131722</span>
<span class="go">2         0.025913  0.011190  0.020903  0.017632  0.019309</span>
<span class="go">3         0.017579  0.035281  0.067338  0.102785  0.151069</span>
<span class="go">13        0.024869  0.047189  0.069974  0.103514  0.128603</span>
<span class="go">14        0.031036  0.061392  0.093781  0.091846  0.092186</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit2</span><span class="p">,</span> <span class="n">fit_err2</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="s2">&quot;brownian&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit2</span>
<span class="go">parameter         D       eps</span>
<span class="go">particle</span>
<span class="go">0          0.087792 -0.003802</span>
<span class="go">2         -0.036809  0.098699</span>
<span class="go">3          0.044256 -0.001375</span>
<span class="go">13         0.055800  0.009597</span>
<span class="go">14         0.075891  0.002834</span>
</pre></div>
</div>
<p>Similarly, multiple diffusing components can be identified by analysing the
MSD distributions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m3</span> <span class="o">=</span> <span class="n">MsdDist</span><span class="p">(</span><span class="n">trc</span><span class="p">,</span> <span class="n">frame_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_lag</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, one gets the MSDs and errors for each component:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">m3</span><span class="o">.</span><span class="n">get_msd</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span><span class="o">.</span><span class="n">msd</span>
<span class="go">lagt</span>
<span class="go">0.1    0.084859</span>
<span class="go">0.2    1.245575</span>
<span class="go">0.3    0.093846</span>
<span class="go">0.4    0.649084</span>
<span class="go">0.5    1.220108</span>
<span class="go">Name: ensemble, dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span><span class="o">.</span><span class="n">msd</span>
<span class="go">0.1    1.161134</span>
<span class="go">0.2    2.474728</span>
<span class="go">0.3    3.216000</span>
<span class="go">0.4    4.600476</span>
<span class="go">0.5    5.857745</span>
<span class="go">Name: ensemble, dtype: float64</span>
</pre></div>
</div>
<p>Fitting of a model works similarly to <a class="reference internal" href="#sdt.motion.Msd" title="sdt.motion.Msd"><code class="xref py py-class docutils literal notranslate"><span class="pre">Msd</span></code></a>, but yields results for
each component:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bm3</span> <span class="o">=</span> <span class="n">m3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="s2">&quot;brownian&quot;</span><span class="p">,</span> <span class="n">n_lag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">bm3</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r1</span><span class="o">.</span><span class="n">fit</span>
<span class="go">D         0.418502</span>
<span class="go">eps       0.197795</span>
<span class="go">weight    0.083748</span>
<span class="go">Name: ensemble, dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span><span class="o">.</span><span class="n">fit</span>
<span class="go">D         2.879742</span>
<span class="go">eps       0.039767</span>
<span class="go">weight    0.916252</span>
<span class="go">Name: ensemble, dtype: float64</span>
</pre></div>
</div>
<p>This can also be plotted:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bm3</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Analysis can be carried out for each track individually by setting
<code class="docutils literal notranslate"><span class="pre">ensemble=False</span></code>.</p>
<p>Immobilized parts of particle trajectories can be found using
<a class="reference internal" href="#sdt.motion.find_immobilizations" title="sdt.motion.find_immobilizations"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_immobilizations()</span></code></a>. It adds a column named “immob” to the
DataFrame that identify mobile and immobile parts of trajectories. Where
“immob” &gt;= 0, the particle is immobile and where “immob” &lt; 0, it is mobile.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_immobilizations</span><span class="p">(</span><span class="n">trc</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">           x          y       mass  frame  particle  immob</span>
<span class="go">0  13.276002  58.640033  1711.1778    1.0       0.0      0</span>
<span class="go">1  13.058399  58.870968  1742.6831    2.0       0.0      0</span>
<span class="go">2  12.624088  58.132507  2527.7880    3.0       0.0      0</span>
<span class="go">3  13.651173  57.980727  2461.9288    5.0       0.0      0</span>
<span class="go">4  13.482774  58.122870  2508.9154    6.0       0.0      0</span>
</pre></div>
</div>
<section id="msd-calculation">
<h2>MSD calculation<a class="headerlink" href="#msd-calculation" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sdt.motion.Msd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sdt.motion.</span></span><span class="sig-name descname"><span class="pre">Msd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_boot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ensemble'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#Msd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.Msd" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate and analyze mean square displacements (MSDs)</p>
<p>from single moleclue tracking data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em><em> or </em><em>iterable</em><em> of </em><em>pandas.DataFrame</em>) – Tracking data. Either a single DataFrame or a collection of
DataFrames.</p></li>
<li><p><strong>frame_rate</strong> (<em>float</em>) – Frame rate</p></li>
<li><p><strong>n_lag</strong> (<em>int</em><em> or </em><em>inf</em><em>, </em><em>optional</em>) – Number of lag times (time steps) to consider at most. Defaults to
100.</p></li>
<li><p><strong>n_boot</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bootstrapping iterations for calculation of errors.
Set to 0 to turn off bootstrapping for performance gain, in which
case there will be no errors on the fit results. Defaults to 100.</p></li>
<li><p><strong>ensemble</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to calculate the MSDs for the whole data set or for each
trajectory individually. Defaults to True.</p></li>
<li><p><strong>pixel_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Pixel size; multiply coordinates by this factor. Defaults to 1
(no scaling).</p></li>
<li><p><strong>e_name</strong> (<em>str</em><em>, </em><em>optional</em>) – If the <cite>ensemble</cite> parameter is <cite>True</cite>, use this as the name for
the dataset. It shows up in the MSD DataFrame (see
<a class="reference internal" href="#sdt.motion.Msd.get_msd" title="sdt.motion.Msd.get_msd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_msd()</span></code></a>) and in plots. Defaults to “ensemble”.</p></li>
<li><p><strong>random_state</strong> (<em>numpy.random.RandomState</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code> instance to use for
random sampling for bootstrapping. If <cite>None</cite>, use create a new
instance with <code class="docutils literal notranslate"><span class="pre">seed=None</span></code>. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>columns</strong> (<em>dict</em><em>, </em><em>optional</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. Relevant names are <cite>coords</cite>, <cite>particle</cite>,
and <cite>time</cite>. This means, if your DataFrame has coordinate columns
“x”, “y”, and “z” and the time column “alt_frame”, set
<code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;y&quot;,</span> <span class="pre">&quot;z&quot;],</span> <span class="pre">&quot;time&quot;:</span> <span class="pre">&quot;alt_frame&quot;}</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sdt.motion.Msd.Result">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msd_err</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sdt.motion.Msd.Result" title="Permalink to this definition">#</a></dt>
<dd><p>Create new instance of Result(msd, msd_err)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.motion.Msd.Result.msd">
<span class="sig-name descname"><span class="pre">msd</span></span><a class="headerlink" href="#sdt.motion.Msd.Result.msd" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.motion.Msd.Result.msd_err">
<span class="sig-name descname"><span class="pre">msd_err</span></span><a class="headerlink" href="#sdt.motion.Msd.Result.msd_err" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.Msd.get_msd">
<span class="sig-name descname"><span class="pre">get_msd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#Msd.get_msd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.Msd.get_msd" title="Permalink to this definition">#</a></dt>
<dd><p>Get MSD and error DataFrames</p>
<p>The columns contain data for different lag times. Each row corresponds
to one trajectory. The row index is either the particle number if a
single DataFrame was passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code> or a tuple
identifying both the DataFrame and the particle. If
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code> was called with <code class="docutils literal notranslate"><span class="pre">ensemble=True</span></code>, there will only
be one row with index <cite>e_name</cite>.</p>
<p>The <cite>series</cite> parameter controls whether to return a
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code> if there is
only one row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>series</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite> and and there is only one entry (e.g., due to
<code class="docutils literal notranslate"><span class="pre">ensemble=True</span></code> in the constructor), <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code>
objects will be returned. Otherwise, return
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>. Defaults to <cite>True</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>msd</strong> (<em>pandas.DataFrame or pandas.Series</em>) – Mean square displacements</p></li>
<li><p><strong>msd_err</strong> (<em>pandas.DataFrame or pandas.Series</em>) – Standard errors of the mean square displacements. If
bootstrapping was used, these are the standard deviations of the
MSD results from bootstrapping. Otherwise, these are caleculated
as the standard deviation of square displacements divided by the
number of samples.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.Msd.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'brownian'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#Msd.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.Msd.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Fit a model function to the MSD data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>{&quot;anomalous&quot;</em><em>, </em><em>&quot;brownian&quot;}</em><em>, </em><em>optional</em>) – Type of model to fit. Defaults to “brownian”.</p></li>
<li><p><strong>n_lag</strong> (<em>int</em><em> or </em><em>inf</em><em>, </em><em>optional</em>) – Number of lag times to use for fitting. Defaults to 2 for the
Brownian model and <cite>inf</cite> for anomalous diffusion.</p></li>
<li><p><strong>exposure_time</strong> (<em>float</em><em>, </em><em>optional</em>) – Exposure time. Defaults to 0, i.e. no exposure time compensation</p></li>
<li><p><strong>initial</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>len 3</em><em>, </em><em>optional</em>) – Initial guess for fitting anomalous diffusion. The tuple entries
are diffusion coefficient, positional accuracy, and alpha.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sdt.motion.MsdDist">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sdt.motion.</span></span><span class="sig-name descname"><span class="pre">MsdDist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_boot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lsq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ensemble'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'msd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd_dist.html#MsdDist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.MsdDist" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate and analyze mean square displacement (MSD) distribution</p>
<p>from single moleclue tracking data. This differs from
<a class="reference internal" href="#sdt.motion.Msd" title="sdt.motion.Msd"><code class="xref py py-class docutils literal notranslate"><span class="pre">sdt.motion.Msd</span></code></a> by the fact that the distributions
are analyzed, which allows for detection of multiple
components with different diffusion coefficients <a class="reference internal" href="#schu1997" id="id1"><span>[Schu1997]</span></a>.</p>
<p>Only valid for 2D data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em><em> or </em><em>iterable</em><em> of </em><em>pandas.DataFrame</em>) – Tracking data. Either a single DataFrame or a collection of
DataFrames.</p></li>
<li><p><strong>frame_rate</strong> (<em>float</em>) – Frame rate</p></li>
<li><p><strong>n_components</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of diffusing components. Defaults to 2.</p></li>
<li><p><strong>n_lag</strong> (<em>int</em><em> or </em><em>inf</em><em>, </em><em>optional</em>) – Number of lag times (time steps) to consider at most. Defaults to
10.</p></li>
<li><p><strong>n_boot</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bootstrapping iterations for calculation of errors.
Set to 0 to turn off bootstrapping for performance gain, in which
case there will be no errors on the fit results. Defaults to 0.</p></li>
<li><p><strong>ensemble</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to calculate the MSDs for the whole data set or for each
trajectory individually. Defaults to True.</p></li>
<li><p><strong>fit_method</strong> (<em>{&quot;prony&quot;</em><em>, </em><em>&quot;lsq&quot;</em><em>, </em><em>&quot;weighted-lsq&quot;}</em><em>, </em><em>optional</em>) – Method to use for cumulative distribution function (CDF) fitting.
“prony” is a modified Prony’s method, “lsq” is least squares
fitting, and “weighted-lsq” is weighted least squares fitting to
account for the fact that the CDF data are concentrated at x=0.
Defaults to “lsq”.</p></li>
<li><p><strong>pixel_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Pixel size; multiply coordinates by this factor. Defaults to 1
(no scaling).</p></li>
<li><p><strong>assign_method</strong> (<em>{&quot;msd&quot;</em><em>, </em><em>&quot;weight&quot;}</em><em>, </em><em>optional</em>) – If “msd”, components are assigned according to increasing MSDs,
i.e., lowest MSD will be component 1, next will be component 2,
and so on. If “weight”, components are assigned according to
increasing weights. Defaults to “msd”.</p></li>
<li><p><strong>e_name</strong> (<em>str</em><em>, </em><em>optional</em>) – If the <cite>ensemble</cite> parameter is <cite>True</cite>, use this as the name for
the dataset. It shows up in the MSD DataFrame (see
<a class="reference internal" href="#sdt.motion.MsdDist.get_msd" title="sdt.motion.MsdDist.get_msd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_msd()</span></code></a>) and in plots. Defaults to “ensemble”.</p></li>
<li><p><strong>random_state</strong> (<em>numpy.random.RandomState</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code> instance to use for
random sampling for bootstrapping. If <cite>None</cite>, use create a new
instance with <code class="docutils literal notranslate"><span class="pre">seed=None</span></code>. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>columns</strong> (<em>dict</em><em>, </em><em>optional</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. Relevant names are <cite>coords</cite>, <cite>particle</cite>,
and <cite>time</cite>. This means, if your DataFrame has coordinate columns
“x” and “z” and the time column “alt_frame”, set
<code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;],</span> <span class="pre">&quot;time&quot;:</span> <span class="pre">&quot;alt_frame&quot;}</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sdt.motion.MsdDist.Result">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msd_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_err</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sdt.motion.MsdDist.Result" title="Permalink to this definition">#</a></dt>
<dd><p>Create new instance of Result(msd, msd_err, weight, weight_err)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.motion.MsdDist.Result.msd">
<span class="sig-name descname"><span class="pre">msd</span></span><a class="headerlink" href="#sdt.motion.MsdDist.Result.msd" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.motion.MsdDist.Result.msd_err">
<span class="sig-name descname"><span class="pre">msd_err</span></span><a class="headerlink" href="#sdt.motion.MsdDist.Result.msd_err" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.motion.MsdDist.Result.weight">
<span class="sig-name descname"><span class="pre">weight</span></span><a class="headerlink" href="#sdt.motion.MsdDist.Result.weight" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.motion.MsdDist.Result.weight_err">
<span class="sig-name descname"><span class="pre">weight_err</span></span><a class="headerlink" href="#sdt.motion.MsdDist.Result.weight_err" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.MsdDist.get_msd">
<span class="sig-name descname"><span class="pre">get_msd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd_dist.html#MsdDist.get_msd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.MsdDist.get_msd" title="Permalink to this definition">#</a></dt>
<dd><p>Get MSD and error DataFrames</p>
<p>The columns contain data for different lag times. Each row corresponds
to one trajectory. The row index is either the particle number if a
single DataFrame was passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code> or a tuple
identifying both the DataFrame and the particle. If
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code> was called with <code class="docutils literal notranslate"><span class="pre">ensemble=True</span></code>, there will only
be one row with index <cite>e_name</cite>.</p>
<p>If there is only one row, the <cite>series</cite> parameter controls whether to
return a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>series</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite> and and there is only one entry (e.g., due to
<code class="docutils literal notranslate"><span class="pre">ensemble=True</span></code> in the constructor), <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code>
objects will be returned. Otherwise, return
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>. Defaults to <cite>True</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Each tuple describes one component. The tuple members are
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code>
(depending on the <cite>series</cite> parameter), where <cite>msd</cite> holds the mean
square displacements, <cite>msd_err</cite> contains standard errors of the
MSDs, <cite>weight</cite> hold the relative weight of the component calculated
for the different lag times, and <cite>weight_err</cite> contains standard
errors of the weights. If no bootstrapping was performed, all
errors are <cite>NaN</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of namedTuple([“msd”, “msd_err”, “weight”, “weight_err”])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.MsdDist.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'brownian'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd_dist.html#MsdDist.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.MsdDist.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Fit a model function to the MSD data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>{&quot;anomalous&quot;</em><em>, </em><em>&quot;brownian&quot;}</em>) – Type of model to fit</p></li>
<li><p><strong>n_lag</strong> (<em>int</em><em> or </em><em>inf</em><em>, </em><em>optional</em>) – Number of lag times to use for fitting. Defaults to 2 for the
Brownian model and <cite>inf</cite> for anomalous diffusion.</p></li>
<li><p><strong>exposure_time</strong> (<em>float</em><em>, </em><em>optional</em>) – Exposure time. Defaults to 0, i.e. no exposure time compensation</p></li>
<li><p><strong>initial</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>len 3</em><em>, </em><em>optional</em>) – Initial guess for fitting anomalous diffusion. The tuple entries
are diffusion coefficient, positional accuracy, and alpha.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="diffusion-models-for-fitting">
<h2>Diffusion models for fitting<a class="headerlink" href="#diffusion-models-for-fitting" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sdt.motion.AnomalousDiffusion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sdt.motion.</span></span><span class="sig-name descname"><span class="pre">AnomalousDiffusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msd_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.05,</span> <span class="pre">1.0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#AnomalousDiffusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.AnomalousDiffusion" title="Permalink to this definition">#</a></dt>
<dd><p>Fit anomalous diffusion parameters to MSD values</p>
<p>Fit a function <span class="math notranslate nohighlight">\(msd(t_\text{lag}) = 4 D t_\text{lag}^\alpha +
4 \epsilon^2\)</span>
to the tlag-vs.-MSD graph, where <span class="math notranslate nohighlight">\(D\)</span> is the diffusion coefficient,
<span class="math notranslate nohighlight">\(\epsilon\)</span> is the positional accuracy (uncertainty), and
<span class="math notranslate nohighlight">\(\alpha\)</span> the anomalous diffusion exponent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msd_data</strong> (<em>msd_base.MsdData</em>) – MSD data</p></li>
<li><p><strong>n_lag</strong> (<em>int</em><em> or </em><em>inf</em><em>, </em><em>optional</em>) – Maximum number of lag times to use for fitting. Defaults to
<cite>inf</cite>, i.e. using all.</p></li>
<li><p><strong>exposure_time</strong> (<em>float</em><em>, </em><em>optional</em>) – Exposure time. Defaults to 0, i.e. no exposure time correction</p></li>
<li><p><strong>initial</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Initial guesses for the fitting for <span class="math notranslate nohighlight">\(D\)</span>, <span class="math notranslate nohighlight">\(\epsilon\)</span>,
and <span class="math notranslate nohighlight">\(\alpha\)</span>. Defaults to <code class="docutils literal notranslate"><span class="pre">(0.5,</span> <span class="pre">0.05,</span> <span class="pre">1.)</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.AnomalousDiffusion.exposure_time_corr">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exposure_time_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_numeric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#AnomalousDiffusion.exposure_time_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.AnomalousDiffusion.exposure_time_corr" title="Permalink to this definition">#</a></dt>
<dd><p>Correct lag times for the movement of particles during exposure</p>
<p>When particles move during exposure, it appears as if the lag times
change according to</p>
<div class="math notranslate nohighlight">
\[t_\text{app}^\alpha = \lim_{n\rightarrow\infty} \frac{1}{n^2}
\sum_{m_1 = 0}^{n-1} \sum_{m_2 = 0}^{n-1} |t +
\frac{t_\text{exp}}{n}(m_1 - m_2)|^\alpha -
|\frac{t_\text{exp}}{n}(m_1 - m_2)|^\alpha.\]</div>
<p>For <span class="math notranslate nohighlight">\(\alpha=1\)</span>, <span class="math notranslate nohighlight">\(t_\text{app} = t - t_\text{exp} / 3\)</span>. For
<span class="math notranslate nohighlight">\(t_\text{exp} = 0\)</span> or <span class="math notranslate nohighlight">\(\alpha = 2\)</span>,
<span class="math notranslate nohighlight">\(t_\text{app} = t\)</span>. For other parameter values, the sum is
computed numerically using a sufficiently large <cite>n</cite> (100 by default).</p>
<p>See <a class="reference internal" href="#goul2000" id="id2"><span>[Goul2000]</span></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>numpy.ndarray</em>) – Lag times</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Anomalous diffusion exponent</p></li>
<li><p><strong>exposure_time</strong> (<em>float</em>) – Exposure time</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of summands for the numeric calculation. The complexity
of the algorithm is O(n²). Defaults to 100.</p></li>
<li><p><strong>force_numeric</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, do not return the analytical solutions for
<span class="math notranslate nohighlight">\(\alpha \in \{1, 2\}\)</span> and <span class="math notranslate nohighlight">\(t_\text{exp} = 0\)</span>, but
calculate numerically. Useful for testing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Apparent lag times that account for diffusion during exposure</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.AnomalousDiffusion.theoretical">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theoretical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_result</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#AnomalousDiffusion.theoretical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.AnomalousDiffusion.theoretical" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate theoretical MSDs for different lag times</p>
<p>Calculate <span class="math notranslate nohighlight">\(msd(t_\text{lag}) = 4 D t_\text{app}^\alpha + 4
\epsilon^2\)</span>, where <span class="math notranslate nohighlight">\(t_\text{app}\)</span> is the apparent time lag which
takes into account particle motion during exposure; see
<a class="reference internal" href="#sdt.motion.AnomalousDiffusion.exposure_time_corr" title="sdt.motion.AnomalousDiffusion.exposure_time_corr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exposure_time_corr()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>array-like</em><em> or </em><em>scalar</em>) – Lag times</p></li>
<li><p><strong>d</strong> (<em>float</em>) – Diffusion coefficient</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Positional accuracy.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Anomalous diffusion exponent. Defaults to 1.</p></li>
<li><p><strong>exposure_time</strong> (<em>float</em><em>, </em><em>optional</em>) – Exposure time. Defaults to 0.</p></li>
<li><p><strong>squeeze_result</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, return the result as a scalar type or 1D array if
possible. Otherwise, always return a 2D array. Defaults to <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Calculated theoretical MSDs</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray or scalar</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sdt.motion.AnomalousDiffusion.Result">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_err</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sdt.motion.AnomalousDiffusion.Result" title="Permalink to this definition">#</a></dt>
<dd><p>Create new instance of Result(fit, fit_err)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.motion.AnomalousDiffusion.Result.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><a class="headerlink" href="#sdt.motion.AnomalousDiffusion.Result.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sdt.motion.AnomalousDiffusion.Result.fit_err">
<span class="sig-name descname"><span class="pre">fit_err</span></span><a class="headerlink" href="#sdt.motion.AnomalousDiffusion.Result.fit_err" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.AnomalousDiffusion.get_results">
<span class="sig-name descname"><span class="pre">get_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#AnomalousDiffusion.get_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.AnomalousDiffusion.get_results" title="Permalink to this definition">#</a></dt>
<dd><p>Get fit results</p>
<p>The columns contain fitted parameters. Each row corresponds
to one trajectory. The row index is either the particle number or a
tuple identifying both the DataFrame and the particle; c.f.
<a class="reference internal" href="#sdt.motion.Msd" title="sdt.motion.Msd"><code class="xref py py-class docutils literal notranslate"><span class="pre">Msd</span></code></a>.</p>
<p>If there is only one row, the <cite>series</cite> parameter controls whether to
return a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>series</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite> and and there is only one entry (e.g., due to
<code class="docutils literal notranslate"><span class="pre">ensemble=True</span></code> in the <a class="reference internal" href="#sdt.motion.Msd" title="sdt.motion.Msd"><code class="xref py py-class docutils literal notranslate"><span class="pre">Msd</span></code></a> constructor),
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code> objects will be returned. Otherwise,
return <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>. Defaults to <cite>True</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fit</strong> (<em>pandas.DataFrame or pandas.Series</em>) – Fit results. Columns are the fit paramaters. Each row represents
one particle.</p></li>
<li><p><strong>fit_err</strong> (<em>pandas.DataFrame or pandas.Series</em>) – Fit results standard errors. If no bootstrapping was performed
for calculation of MSDs, this is all NaNs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.AnomalousDiffusion.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#AnomalousDiffusion.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.AnomalousDiffusion.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot lag time vs. MSD with fitted theoretical curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add a legend to the plot. Defaults to <cite>True</cite>.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Axes to use for plotting. If <cite>None</cite>, use <code class="docutils literal notranslate"><span class="pre">pyplot.gca()</span></code>.
Defaults to <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axes used for plotting</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sdt.motion.BrownianMotion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sdt.motion.</span></span><span class="sig-name descname"><span class="pre">BrownianMotion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msd_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#BrownianMotion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.BrownianMotion" title="Permalink to this definition">#</a></dt>
<dd><p>Fit Brownian motion parameters to MSD values</p>
<p>Fit a function <span class="math notranslate nohighlight">\(\mathit{msd}(t_\text{lag}) = 4 D t_\text{lag} +
4 \epsilon^2\)</span> to
the tlag-vs.-MSD graph, where <span class="math notranslate nohighlight">\(D\)</span> is the diffusion coefficient and
<span class="math notranslate nohighlight">\(\epsilon\)</span> is the positional accuracy (uncertainty).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msd_data</strong> (<em>msd_base.MsdData</em>) – MSD data</p></li>
<li><p><strong>n_lag</strong> (<em>int</em><em> or </em><em>inf</em><em>, </em><em>optional</em>) – Maximum number of lag times to use for fitting. Defaults to 2.</p></li>
<li><p><strong>exposure_time</strong> (<em>float</em><em>, </em><em>optional</em>) – Exposure time. Defaults to 0, i.e. no exposure time correction</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sdt.motion.BrownianMotion.theoretical">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theoretical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/msd.html#BrownianMotion.theoretical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.BrownianMotion.theoretical" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate theoretical MSDs for different lag times</p>
<p>Calculate <span class="math notranslate nohighlight">\(msd(t_\text{lag}) = 4 D t_\text{app} + 4
\epsilon^2\)</span>, where <span class="math notranslate nohighlight">\(t_\text{app}\)</span> is the apparent time lag
which takes into account particle motion during exposure; see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">exposure_time_corr()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>array-like</em><em> or </em><em>scalar</em>) – Lag times</p></li>
<li><p><strong>d</strong> (<em>float</em>) – Diffusion coefficient</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Positional accuracy.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Anomalous diffusion exponent. Defaults to 1.</p></li>
<li><p><strong>exposure_time</strong> (<em>float</em><em>, </em><em>optional</em>) – Exposure time. Defaults to 0.</p></li>
<li><p><strong>squeeze_result</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite>, return the result as a scalar type or 1D array if
possible. Otherwise, always return a 2D array. Defaults to <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Calculated theoretical MSDs</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray or scalar</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="immobilization-detection">
<h2>Immobilization detection<a class="headerlink" href="#immobilization-detection" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="sdt.motion.find_immobilizations">
<span class="sig-prename descclassname"><span class="pre">sdt.motion.</span></span><span class="sig-name descname"><span class="pre">find_immobilizations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_mobile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longest_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numba'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/immobilization.html#find_immobilizations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.find_immobilizations" title="Permalink to this definition">#</a></dt>
<dd><p>Find immobilizations in particle trajectories</p>
<p>Analyze trajectories and mark parts where all localizations of a particle
stay within a circle of radius <cite>max_dist</cite> from their center of mass for at
least a certain number (<cite>min_length</cite>) of frames as an immobilization.</p>
<p>The <cite>tracks</cite> DataFrame gets a new column (“immob”) appended
(or overwritten), where every immobilzation is assigned a different number
greater or equal than 0. Parts of trajectories that are not immobilized
are assigned -1 (if <cite>label_mobile</cite> is <cite>False</cite>) or one negative number
per mobile section starting at -2 (if label_mobile is <cite>True</cite>).</p>
<p><a class="reference internal" href="#sdt.motion.find_immobilizations_int" title="sdt.motion.find_immobilizations_int"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_immobilizations_int()</span></code></a> uses a slightly different criterion
for finding immobilizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (<em>pandas.DataFrame</em>) – Tracking data</p></li>
<li><p><strong>max_dist</strong> (<em>float</em>) – Maximum radius within a particle may move while still being considered
immobilized</p></li>
<li><p><strong>min_duration</strong> (<em>int</em>) – Minimum duration the particle has to stay at the same place
for a part of a trajectory to be considered immobilized. Duration
is the difference of the maximum frame number and the minimum frame
number. E. g. if the frames 1, 2, and 4 would lead to a duration of 3.</p></li>
<li><p><strong>label_mobile</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to give each mobile track section a distinct label (a negative
number starting at -2). Defaults to True.</p></li>
<li><p><strong>longest_only</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, search only for the longest immobilzation in each track to
speed up the process. Defaults to False.</p></li>
<li><p><strong>rtol</strong> (<em>float</em><em>, </em><em>optional</em>) – The fraction of localizations that may not be within <cite>max_dist</cite> of
the center of mass while still recognizing the sub-track as immobile.
One also has to set the <cite>a_tol</cite> parameter to something non-zero if
using this since a sub-track will not be considered immobile if either
<cite>r_tol</cite> or <cite>a_tol</cite> are exceeded. Defaults to 0.</p></li>
<li><p><strong>atol</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of localizations that may not be within <cite>max_dist</cite> of
the center of mass while still recognizing the sub-track as immobile.
One also has to set the <cite>r_tol</cite> parameter to something non-zero if
using this since a sub-track will not be considered immobile if either
<cite>r_tol</cite> or <cite>a_tol</cite> are exceeded. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Although the <cite>tracks</cite> DataFrame is modified in place, it is also
returned for convenience.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sdt.motion.find_immobilizations_int" title="sdt.motion.find_immobilizations_int"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_immobilizations_int</span></code></a></dt><dd><p>Uses a slightly different criterion for finding immobilizations</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>engine</strong> (<em>{&quot;numba&quot;</em><em>, </em><em>&quot;python&quot;}</em><em>, </em><em>optional</em>) – If <cite>engine</cite> is “numba” and the <cite>numba</cite> package is installed, use the
much faster numba-accelerated alogrithm. Otherwise, fall back to a
pure python one. Defaults to “numba”</p></li>
<li><p><strong>columns</strong> (<em>dict</em><em>, </em><em>optional</em>) – Override default column names as defined in <code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>.
Relevant names are <cite>coords</cite>, <cite>time</cite>, and <cite>particle</cite>.
This means, if your DataFrame has coordinate columns “x” and “z” and
the time column “alt_frame”, set <code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;],</span>
<span class="pre">&quot;time&quot;:</span> <span class="pre">&quot;alt_frame&quot;}</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sdt.motion.label_mobile">
<span class="sig-prename descclassname"><span class="pre">sdt.motion.</span></span><span class="sig-name descname"><span class="pre">label_mobile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numba'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/immobilization.html#label_mobile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.label_mobile" title="Permalink to this definition">#</a></dt>
<dd><p>Give each mobile section of a track a label (unique number)</p>
<p>When calling <a class="reference internal" href="#sdt.motion.find_immobilizations" title="sdt.motion.find_immobilizations"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_immobilizations()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">label_mobile=False</span></code>,
all mobile sections of tracks will have <cite>-1</cite> in their <cite>immob</cite> column.
This function assigns a unique (negative) number to each section,
starting at <cite>-2</cite>.</p>
<p>The <cite>data</cite> DataFrame will be modified in place, but also returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (<em>DataFrame</em>) – Tracking data with an <cite>immob</cite> column where all mobile sections of
tracks are assigned <cite>-1</cite>.</p></li>
<li><p><strong>engine</strong> (<em>Literal</em><em>[</em><em>'numba'</em><em>, </em><em>'python'</em><em>]</em>) – If <cite>engine</cite> is “numba” and the <cite>numba</cite> package is installed, use the
much faster numba-accelerated alogrithm. Otherwise, fall back to a
pure python one. Defaults to “numba”</p></li>
<li><p><strong>columns</strong> (<em>Mapping</em>) – Override default column names as defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>. The only relevant name is <cite>particle</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>tracks</cite> with updated <code class="docutils literal notranslate"><span class="pre">&quot;immob&quot;</span></code> column.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sdt.motion.find_immobilizations_int">
<span class="sig-prename descclassname"><span class="pre">sdt.motion.</span></span><span class="sig-name descname"><span class="pre">find_immobilizations_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_mobile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longest_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sdt/motion/immobilization.html#find_immobilizations_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sdt.motion.find_immobilizations_int" title="Permalink to this definition">#</a></dt>
<dd><p>Find immobilizations in particle trajectories</p>
<p>Analyze trajectories and mark parts where all localizations of a particle
stay within a circle of radius <cite>max_dist</cite> for at least a certain number
(<cite>min_length</cite>) of frames as an immobilization. In other words: If
consecutive localizations stay within the intersection of circles of
radius <cite>max_dist</cite> and coordinates of the localizations as centers, they
are considered immobilized.</p>
<p>This is different from <a class="reference internal" href="#sdt.motion.find_immobilizations" title="sdt.motion.find_immobilizations"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_immobilizations()</span></code></a>.</p>
<p>The <cite>tracks</cite> DataFrame gets a new column (“immob”) appended
(or overwritten), where every immobilzation is assigned a different number
greater or equal than 0. Parts of trajectories that are not immobilized
are assigned -1 (if <cite>label_mobile</cite> is <cite>False</cite>) or one negative number
per mobile section starting at -2 (if label_mobile is <cite>True</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (<em>pandas.DataFrame</em>) – Tracking data</p></li>
<li><p><strong>max_dist</strong> (<em>float</em>) – Maximum radius within a particle may move while still being considered
immobilized</p></li>
<li><p><strong>min_duration</strong> (<em>int</em>) – Minimum duration the particle has to stay at the same place
for a part of a trajectory to be considered immobilized. Duration
is the difference of the maximum frame number and the minimum frame
number. E. g. if the frames 1, 2, and 4 would lead to a duration of 3.</p></li>
<li><p><strong>label_mobile</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to give each mobile track section a distinct label (a negative
number starting at -2). Defaults to True.</p></li>
<li><p><strong>longest_only</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, search only for the longest immobilzation in each track to
speed up the process. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Although the <cite>tracks</cite> DataFrame is modified in place, it is also
returned for convenience.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sdt.motion.find_immobilizations" title="sdt.motion.find_immobilizations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_immobilizations</span></code></a></dt><dd><p>Uses a slightly different criterion for finding immobilizations</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>columns</strong> (<em>dict</em><em>, </em><em>optional</em>) – Override default column names as defined in <code class="xref py py-attr docutils literal notranslate"><span class="pre">config.columns</span></code>.
Relevant names are <cite>coords</cite>, <cite>time</cite>, and <cite>particle</cite>.
This means, if your DataFrame has coordinate columns “x” and “z” and
the time column “alt_frame”, set <code class="docutils literal notranslate"><span class="pre">columns={&quot;coords&quot;:</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;z&quot;],</span>
<span class="pre">&quot;time&quot;:</span> <span class="pre">&quot;alt_frame&quot;}</span></code>.</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="goul2000" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Goul2000</a><span class="fn-bracket">]</span></span>
<p>Goulian, M. &amp; Simon, S. M.: “Tracking Single Proteins within
Cells”, Biophysical Journal, Elsevier BV, 2000, 79, 2188–2198</p>
</div>
<div class="citation" id="schu1997" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Schu1997</a><span class="fn-bracket">]</span></span>
<p>Schütz, G.; Schindler, H. &amp; Schmidt, T.: “Single-molecule
microscopy on model membranes reveals anomalous diffusion”, Biophysical
Journal, Elsevier BV, 1997, 73, 1073–1080</p>
</div>
</div>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="multicolor.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Multi-color data analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="brightness.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Brightness analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#msd-calculation">MSD calculation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd"><code class="docutils literal notranslate"><span class="pre">Msd</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.Result"><code class="docutils literal notranslate"><span class="pre">Msd.Result</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.Result.msd"><code class="docutils literal notranslate"><span class="pre">Msd.Result.msd</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.Result.msd_err"><code class="docutils literal notranslate"><span class="pre">Msd.Result.msd_err</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.get_msd"><code class="docutils literal notranslate"><span class="pre">Msd.get_msd()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.Msd.fit"><code class="docutils literal notranslate"><span class="pre">Msd.fit()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist"><code class="docutils literal notranslate"><span class="pre">MsdDist</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result.msd"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result.msd</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result.msd_err"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result.msd_err</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result.weight"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result.weight</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.Result.weight_err"><code class="docutils literal notranslate"><span class="pre">MsdDist.Result.weight_err</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.get_msd"><code class="docutils literal notranslate"><span class="pre">MsdDist.get_msd()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.MsdDist.fit"><code class="docutils literal notranslate"><span class="pre">MsdDist.fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-models-for-fitting">Diffusion models for fitting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.exposure_time_corr"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.exposure_time_corr()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.theoretical"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.theoretical()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.Result"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.Result</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.Result.fit"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.Result.fit</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.Result.fit_err"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.Result.fit_err</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.get_results"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.get_results()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.AnomalousDiffusion.plot"><code class="docutils literal notranslate"><span class="pre">AnomalousDiffusion.plot()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.BrownianMotion"><code class="docutils literal notranslate"><span class="pre">BrownianMotion</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.BrownianMotion.theoretical"><code class="docutils literal notranslate"><span class="pre">BrownianMotion.theoretical()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#immobilization-detection">Immobilization detection</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.find_immobilizations"><code class="docutils literal notranslate"><span class="pre">find_immobilizations()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.label_mobile"><code class="docutils literal notranslate"><span class="pre">label_mobile()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sdt.motion.find_immobilizations_int"><code class="docutils literal notranslate"><span class="pre">find_immobilizations_int()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lukas Schrangl
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2015—2023, Lukas Schrangl.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>